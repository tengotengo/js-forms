Forms=function(){function V(a,b){if(typeof a==typeof b&&("string"==typeof b||"number"==typeof b))return a!=b;if("object"==typeof a&&"object"==typeof b){var c;for(c in a)if(V(a[c],b[c]))return!0;for(c in b)if(V(a[c],b[c]))return!0}else if(typeof a!=typeof b)return!0;return!1}function W(){throw new Error(Array.prototype.slice.call(arguments).join(", "))}function X(){console.log(Array.prototype.slice.call(arguments).join(", "))}function Y(a,b){if(a){var c=function(a,b){var c=a.tagName.toLowerCase();switch(c){case"select":for(var d=a.children,e=!1,f=0;f<d.length;f++)b!=d[f].value?(d[f].removeAttribute("selected"),d[f].selected=!1):(d[f].setAttribute("selected","1"),d[f].selected=!0,e=!0);e||(a.selectedIndex=-1);break;case"input":switch(a.type){case"radio":b==a.value?(a.setAttribute("checked","true"),a.checked=!0):(a.removeAttribute("checked"),a.checked=!1);break;case"password":case"hidden":case"text":"object"==typeof b?(a.setAttribute("value",b),a.value=b):(a.setAttribute("value",b),a.value=b);break;case"checkbox":var g=a.hasAttribute("bitmask");g&&a.value&b||b&&"0"!==b&&"!1"!==b&&!g?(a.setAttribute("checked","true"),a.checked=!0):(a.removeAttribute("checked"),a.checked=!1)}break;case"textarea":a.innerHTML=b,a.value=b}};if("object"==typeof b&&a.length)for(var d=0;d<a.length;d++)c(a[d],null!==b&&b[d]?b[d]:null);else if(!a.length||a.tagName)c(a,b);else for(var d=0;d<a.length;d++)c(a[d],b)}}function bb(a,b){var c=a.elements,d={};if(!c)return d;for(var e=0;e<c.length;e++){var f=c[e],g=f.name,h=function(a){var b=a.name,c=a.type,d=a.tagName.toLowerCase();if(!b||a.disabled||"reset"==c||"button"==c||("checkbox"==c||"radio"==c)&&!a.checked||("submit"==c||"image"==c)&&a.form&&a.form.clk!=a||"select"==d&&-1==a.selectedIndex)return null;switch(d){case"select":var e=a.selectedIndex;if(0>e)return null;for(var f=[],g=a.options,h="select-one"==c,i=h?e+1:g.length,j=h?e:0;i>j;j++){var k=g[j];if(k.selected){var l=k.value;if(l||(l=k.attributes&&k.attributes.value&&!k.attributes.value.specified?k.text:k.value),h)return l;f.push(l)}}return f;case"input":switch(c){case"radio":return""===a.value?null:a.value;case"checkbox":return a.hasAttribute("value")?""===a.value?1:a.value:1;case"text":case"password":case"hidden":return""===a.value?null:a.value}break;case"textarea":return""===a.value?null:a.value}return!1};if(g&&!f.disabled&&!$(f,"default-text")){var i=h(f);b&&void 0===ab.get(g,d)&&null===i&&ab.set(g,null,d),null!==i&&(b||""!==i&&null!==i&&void 0!==i)&&(f.hasAttribute("bitmask")?(i=parseInt(i,10)||0,(0!==i||b)&&(d[g]|=i)):ab.set(g,i,d))}}return d}function cb(a,b){if(b){var c={};lb.call(a,function(d){var e=d.name,f=ab.get(e,b);void 0!==f&&(Y(a.container[e],f),c[d.name]||(c[d.name]=1))})}}function db(a,b,c){var d=document.createElement(c.toUpperCase());return d.setAttribute("class","form_"+b+"_"+a),d.setAttribute("name",a),d}function eb(a){var b=document.createElement("SPAN");return b.className=a,Z(b,d.hideClass),b}function fb(a,b){if(b)for(var c in b)a.container[c]||X("field wasn't added",c),void 0!==b[c].defaultVal&&Y(a.container[c],b[c].defaultVal)}function gb(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),!0):a.attachEvent?a.attachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(c=function(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}(a[b],c)),a[b]=c,!0)}function hb(a,b){if(b)for(var c in b)if(void 0!==a.container[c])for(var d in b[c]){var e=null;switch(d){case F:case E:if(!a.container[c])break;if(a.container[c].length)for(var f=0;f<a.container[c].length;f++)a.container[c][f].setAttribute(d,"1");else a.container[c].setAttribute(d,"1");break;case A:e=b[c][d];for(var g in e)a.container[c].setAttribute(g,e[g]);break;case D:if(e=b[c][d],"string"==typeof e)Z(a.container[c],e);else try{for(var f=0;f<e.length;f++)Z(a.container[c],e[f])}catch(h){}}}else X("missing element",c)}function ib(a){var b=a.getConfig();if(!(b[l]&h))return a.submit=function(){a.container.submit.call(a.container)},void 0;var c=function(c){var e=b[o]||d.submitCallback,f=b[v]||d.validateCallback,g=b[n]||d.beforeSubmitCallback,h=b[q]||d.afterSubmitCallback,i=b[m]||function(c){c=c||function(){};var g=a.validate();if(f(g),g){var h=a.getFormData();if(b[y])for(var i in b[y])h[i]=b[y][i];return d.ajax(a.action,"POST",h,function(a){return function(b,c){e(b,c,a)}}(c)),a.saveChanges(),!0}return!1};g(function(){i(c)&&h()})};a.container.submit=a.submit=c,gb(a.container,"submit",function(a){return a.preventDefault&&a.preventDefault(),c(),a.returnValue=!1,!1})}function jb(a,b){if(void 0!==a){var c;if(document.createEvent){if(c=document.createEvent("MouseEvents"),c.initEvent(b,!0,!1),a.length&&void 0==a.name){for(var d=0;d<a.length;d++)a[d].dispatchEvent(c);return}a.dispatchEvent(c)}else if(document.createEventObject){if(c=document.createEventObject(),void 0===a.fireEvent||"function"!=typeof a.fireEvent)return;a.fireEvent("on"+b,c)}}}function kb(a){var b=function(a,b,c){switch(c){case Forms.VALIDATION_ON_CHANGE:"blur"==a.type&&this.validate(b);break;case Forms.VALIDATION_ON_KEYUP:this.validate(b)}var e=this.getFormData(),f=this.getConfig()[u]||d.onChange,g=this.getConfig()[t]||function(){},h=ab.get(b,this.valuesCache),i=ab.get(b,e),j=V(this.defaultFormData,e);this.isChanged!=j&&f(j,this),this.isChanged=j,V(h,i)&&(g(b,i),ab.set(b,i,this.valuesCache))};lb.call(this,function(c){if(!c.initialized){var d=function(c){return function(d){b.call(this,d,c,a)}.bind(this)}.call(this,c.name);gb(c,"blur",d),gb(c,"click",d),gb(c,"keyup",d),gb(c,"formChange",d),c.initialized=!0}}.bind(this))}function lb(a){for(var b=0;b<c.length;b++)for(var d=this.container.getElementsByTagName(c[b]),e=0;e<d.length;e++)a(d[e])}function mb(a,b,c){var d;if(void 0==a.allChildren){a.allChildren={};for(var e=a.getElementsByTagName("*"),f=0;f<e.length;f++)a.allChildren[e[f].className]=a.allChildren[e[f].className]||[],a.allChildren[e[f].className].push(e[f])}return d=a.allChildren["form_"+c+"_"+b],d?d&&void 0===d.length?d:1==d.length?d[0]:d[0]?d:null:null}function nb(b,c,e,f,g){if(f=f||!1,e=e||!1,g=g||d.templateFast,c){var h=b.container;b.errorContainers={},b.warningContainers={},b.fieldContainers={};var k=function(a,b){var c=document.createElement("LABEL");return c.innerHTML=a,c.setAttribute("for",b),c};for(var l in c){var m=l+"",n=c[m],o=n[B];if(o&&(b.fieldContainers[m]=mb(h,m,H),b.fieldContainers[m])){b.fieldContainers[m].innerHTML="",r=e?m+"-"+a++:m;var p=mb(h,m,K);if(n.label&&p){p.innerHTML="";var q=k(n.label,r);f&&q.setAttribute("title",m),p.appendChild(q)}var r,s={};n.data?s=n.data:n.label?s[n.label]=null:s[""]=null,b.fieldContainers[m].innerHTML=function(a,b,c,d,e,f){var g=[],h=1,i=0;for(var j in a)i++;var k=i>=2;for(var l in a){var n,m=b+(k?"-"+h:""),o={},p=null===a[l]?"":a[l];"select"==c?(0!==j&&(n='<option value=""></option>',g.push({input:n}),j=0),n='<option value="'+p+'">'+l+"</option>"):(n="text"==c||"hidden"==c||"password"==c||"checkbox"==c||"radio"==c?'<input type="'+c+'" name="'+d+'" id="'+m+'" error-id="'+b+'" value="'+p+'" />':'<textarea name="'+d+'" id="'+m+'" error-id="'+b+'" >'+p+"</textarea>",o.label=e?"":'<label for="'+m+'">'+l+"</label>"),o.input=n,g.push(o),h++}return f[c]?f[c](d,b,g):g[0].input}(s,r,o,m,!!p,g)}}}}function ob(a,b){var c=this.notificationContainers[a];if(void 0===c[b]){var e=mb(this.container,b,a);e||(e=db(b,a,this.fieldContainers[b].tagName),this.fieldContainers[b].parentNode.insertBefore(e,this.fieldContainers[b].nextSibling)),e.children.length||e.appendChild(eb(this.getConfig()[a+"Class"]||d.classes[a])),c[b]=e}return this.notificationContainers[a][b].children[0]}function pb(){lb.call(this,function(a){this.setField(a.name,"")}.bind(this))}Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.supplant=function(a,b){return this.replace(/{([^{}]*)}/g,function(c,d){return void 0!=a[d]?a[d]:b?"":c})};var a=1,b={},c=["input","textarea","select"],d={hideClass:"h",classes:{error:"error",warning:"warning"},errorClass:"error",warningClass:"warning",templateFast:{select:function(a,b,c){for(var d='<select name="'+a+'" id="'+b+'">',e=0;e<c.length;e++)d+=c[e].input;return d+="</select>"},radio:function(a,b,c){for(var d='<table cellpadding="0" cellspacing="0" class="radio-table">',e=0;e<c.length;e++)d+='<tr><td class="radiobutton">'+c[e].input+"</td>"+'<td class="radio_label">'+c[e].label+"</td>"+"</tr>";return d+="</table>"},checkbox:function(a,b,c){for(var d='<table cellpadding="0" cellspacing="0" class="checkbox-table">',e=0;e<c.length;e++)d+='<tr><td class="checkbox">'+c[e].input+"</td>"+'<td class="checkbox_label">'+c[e].label+"</td>"+"</tr>";return d+="</table>"}},ajax:function(a,b,c,d,e){var f=new XMLHttpRequest;e=e||function(){},f.open(b,a),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.send(ab.serialize(c,null)),f.onreadystatechange=function(){200==f.status&&4==f.readyState&&d(f.response),200!=f.status&&e()}},onChange:function(){},submitCallback:function(a,b,c){return c(),!0},validateCallback:function(){return!0},beforeSubmitCallback:function(a){return a(),!0},afterSubmitCallback:function(){return!0}},e=1,f=2,g=4,h=8,i="id",j="obj",l="flags",m="onSubmit",n="beforeSubmit",o="submitCallback",q="afterSubmit",r="fields",s="validationType",t="onFieldChange",u="onChange",v="onValidate",w="data",x="templates",y="params",z="action",A="attributes",B="type",C="validate",D="class",E="bitmask",F="disabled",G="warning",H="field",I="warning",J="error",K="label",L="No configuration passed",M="Form is initialized already",N="No such element on the page",O=1,P=2,Q=3,R=2,S=0,T=1,U={setWarningMessage:function(a,b){U.methods[a]||(U.methods[a]=[]),U.methods[a][T]=b},setErrorMessage:function(a,b){U.methods[a]||(U.methods[a]=[]),U.methods[a][S]=b},setTestFunction:function(a,b){U.methods[a]||(U.methods[a]=[]),U.methods[a][R]=b},set:function(a,b){U.methods[a]=b},remove:function(a){delete U.methods[a]},methods:{multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(a,b){return 0===a%b}],email:["Wrong email format","Bad email format",function(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}],"int":["Must be an integer","Should be an integer",function(a){return parseInt(a,10)==a}],"float":["Must be a decimal","Should be a decimal",function(a){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(a)}],min:["Must be >= {val}","Value is lower than {val}",function(a,b){return(parseFloat(a)||0)>=(parseFloat(b)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(a,b){return(parseFloat(a)||0)<=(parseFloat(b)||0)}],date:["Wrong date format","Bad date format",function(a){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(a)}],length:["Must be {val} characters long","Should be {val} characters long",function(a,b){return a.length==b}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(a,b){return a.length<=b}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(a,b){return a.length<=b}],required:["Required field","This field is highly recommended to fill",function(a){return!(""==a||null==a||void 0==typeof a)}]},hideError:function(a){Z(a,d.hideClass)},showError:function(a,b){a.innerHTML=b,_(a,d.hideClass)},field:function(a,b,c,e){var f=!0,g=!0,h=a.getConfig(),i=h.errorClass||d.classes.error,j=h.warningClass||d.classes.warning;if(c[C])for(var k in c[C])if(U.methods[k]){if(("required"==k||""!=e&&null!==e&&void 0!==typeof e)&&(f=U.methods[k][R](e,c[C][k])),!f){U.showError(a.getErrorContainer(b),U.methods[k][S].supplant({val:c[C][k]})),void 0!==a.container[b].name&&Z(a.container[b],i),g=!1;break}a.notificationContainers[J][b]&&U.hideError(a.getErrorContainer(b)),void 0!==a.container[b].name&&_(a.container[b],i)}if(c[G])for(var k in c[G])if(U.methods[k])if(g){if(("required"==k||""!=e&&null!==e&&void 0!==typeof e)&&(f=U.methods[k][R](e,c[G][k])),!f){U.showError(a.getWarningContainer(b),U.methods[k][T].supplant({val:c[G][k]})),void 0!==a.container[b].name&&Z(a.container[b],j);break}a.notificationContainers[I][b]&&U.hideError(a.getWarningContainer(b)),void 0!==a.container[b].name&&_(a.container[b],j)}else a.notificationContainers[I][b]&&U.hideError(a.getWarningContainer(b));return g},process:function(a,b){var c=a.container,d=a.getFormData(),e=!0;for(var f in b)if(void 0!==c[f]){var g=c[f].name?c[f].name:c[f][0].name;U.field(a,g,b[f],d[f])===!1&&(e=!1)}return e}},Z=function(a,b){$(a,b)||(a.className=(a.className+" "+b).trim())},$=function(a,b){return new RegExp("( |^)"+b+"( |$)","g").test(a.className)},_=function(a,b){var c=new RegExp("( |^)"+b+"( |$)","g");a.className=a.className.replace(c,function(a,b,c){return b==c?c:""})},ab={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,serialize:function(a,b){var c=[];for(var d in a){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"==typeof f&&null!==f?ab.serialize(f,e):encodeURIComponent(e)+"="+(null===f?"":encodeURIComponent(f)))}return c.join("&")},get:function(a,b){for(var d,c=[a.replace(ab.isObjReg,"")];d=ab.allReg.exec(a);)c.push(d[1]);if(void 0===b||void 0===b[c[0]])return void 0;for(var e=b,f=0;f<c.length;f++)if(void 0!==e[c[f]]){if(""==e[c[f]])return e[c[f]];e=e[c[f]]}return e},setVal:function(a,b,c){if(a.length){var d=a.shift(),e=a[0],f=c;if(void 0===e){if(""==d)return c.push?(c.push(b),void 0):!1;if(void 0===c)return;return c[d]=b,void 0}""==d&&(f.push||(f=[]),f.push(""==e?[]:{}),d=f.length-1),f=f[d]="object"==typeof f[d]&&null!==f[d]?f[d]:""==e?[]:{},ab.setVal(a,b,f)}},set:function(a,b,c){var d=a.replace(ab.isObjReg,""),e=[];d&&e.push(d);for(var f;f=ab.allReg.exec(a);)e.push(f[1]);ab.setVal(e,b,c)}};return function(a,b){void 0!==window.Element&&(a[b]||(a[b]=function(a){return this.querySelectorAll("."+a)},Element.prototype[b]=a[b]))}(document,"getElementsByClassName"),{Form:function(a){function k(){return c.config}function m(a){return!!a}var c={cache:null,config:a||null,initialized:!1,defaultFormData:null,container:null},h=this;return h.init=function(a){return c.initialized?(X(M),!1):(m(a)||W(L),c.config=a,c.initialized=!0,!0)},h.isChanged=!1,h.getConfig=k,m(c.config)?(c.config[i]&&(c.container=document.getElementById(c.config[i]),c.container||W(N,c.config[i]),h.container=c.container),c.config[j]&&(h.container=c.container=c.config[j],c.config[i]=h.container.id),h.getFormData=function(a){return a=a||!!(c.config[l]&g),bb(h.container,a)},c.config[z]&&c.container.setAttribute(z,c.config[z]),h.ignoreList={},h.action=c.container.getAttribute("action"),h.setField=function(a,b){Y(c.container[a],b),jb(c.container[a],"formChange")},h.getField=function(a){return h.container[a]},h.validate=function(a){if(a){var b=h.getFormData();return U.field(h,a,c.config[r][a],b[a])}return U.process(h,c.config[r])},h.clear=pb.bind(h),h.notificationContainers={},h.notificationContainers[J]={},h.notificationContainers[I]={},h.getErrorContainer=function(a){return ob.call(h,J,a)},h.getWarningContainer=function(a){return ob.call(h,I,a)},h.initInputs=function(){lb.call(h,function(a){void 0===a.hasAttribute&&(a.hasAttribute=function(a){return"undefined"!=typeof this[a]})});for(var a=0,b=0;b<h.container.elements.length;b++){var d=h.container.elements[b];(!d.type||"hidden"!=d.type&&"disabled"!=d.type)&&d.setAttribute("tabindex",++a)}kb.call(h,c.config[s]||Forms.VALIDATION_ON_SUBMIT)},h.saveChanges=function(){h.defaultFormData=h.getFormData(),(c.config[u]||d.onChange)(!1,h),h.isChanged=!1},nb(h,c.config[r],!!(c.config[l]&e),!!(c.config[l]&f),c.config[x]),h.initInputs(),fb(h,c.config[r]),hb(h,c.config[r]),c.config[w]&&cb(h,c.config[w]),h.valuesCache=h.getFormData(),ib(h),h.saveChanges(),c.config[s]===Q&&h.validate(),h.remove=function(){Forms.remove(c.config[i])},h.remove(),b[c.config[i]]=h,void 0):(X(L),void 0)},VALIDATION_ON_SUBMIT:O,VALIDATION_ON_CHANGE:P,VALIDATION_ON_KEYUP:Q,FLAG_DEBUG:f,FLAG_SUBMIT_EMPTY:g,FLAG_UNIQUE_LABELS:e,FLAG_ASYNC:h,defaults:d,remove:function(a){b[a]&&delete b[a]},validation:{setWarningMessage:U.setWarningMessage,setErrorMessage:U.setErrorMessage,setTestFunction:U.setTestFunction,set:U.set,remove:U.remove},getList:function(){return b}}}();