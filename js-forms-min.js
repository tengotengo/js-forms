Forms=function(){function e(t,n){if(typeof t==typeof n&&("string"==typeof n||"number"==typeof n))return t!=n;if("object"==typeof t&&"object"==typeof n){var a;for(a in t)if(e(t[a],n[a]))return!0;for(a in n)if(e(t[a],n[a]))return!0}else if(typeof t!=typeof n)return!0;return!1}function t(){throw Error(Array.prototype.slice.call(arguments).join(", "))}function n(){console.log(Array.prototype.slice.call(arguments).join(", "))}function a(e,t){if(e){var n=function(e,t){var n=e.tagName.toLowerCase();switch(n){case"select":for(var a=e.children,r=!1,i=0;i<a.length;i++)t!=a[i].value?(a[i].removeAttribute("selected"),a[i].selected=!1):(a[i].setAttribute("selected","1"),a[i].selected=!0,r=!0);r||(e.selectedIndex=-1);break;case"input":switch(e.type){case"radio":t==e.value?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1);break;case"password":case"hidden":case"text":"object"==typeof t?(e.setAttribute("value",t),e.value=t):(e.setAttribute("value",t),e.value=t);break;case"checkbox":var o=e.hasAttribute("bitmask");o&&e.value&t||t&&"0"!==t&&"!1"!==t&&!o?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1)}break;case"textarea":e.innerHTML=t,e.value=t}};if("object"==typeof t&&e.length)for(var a=0;a<e.length;a++)n(e[a],t[a]);else if(!e.length||e.tagName)n(e,t);else for(var a=0;a<e.length;a++)n(e[a],t)}}function r(e,t){var n=e.elements,a={};if(!n)return a;for(var r=0;r<n.length;r++){var i=n[r],o=i.name,s=function(e){var t=e.name,n=e.type,a=e.tagName.toLowerCase();if(!t||e.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==a&&-1==e.selectedIndex)return null;switch(a){case"select":var r=e.selectedIndex;if(0>r)return null;for(var i=[],o=e.options,s="select-one"==n,l=s?r+1:o.length,c=s?r:0;l>c;c++){var u=o[c];if(u.selected){var f=u.value;if(f||(f=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),s)return f;i.push(f)}}return i;case"input":switch(n){case"radio":return""===e.value?null:e.value;case"checkbox":return e.hasAttribute("value")?""===e.value?1:e.value:1;case"text":case"password":case"hidden":return""===e.value?null:e.value}break;case"textarea":return""===e.value?null:e.value}return!1};if(o&&!i.disabled&&!ft(i,"default-text")){t&&void 0===ht.get(o,a)&&ht.set(o,null,a);var l=s(i);null!==l&&(t||""!==l&&null!==l&&void 0!==l)&&(i.hasAttribute("bitmask")?(l=parseInt(l,10)||0,(0!==l||t)&&(a[o]|=l)):ht.set(o,l,a))}}return a}function i(e,t){if(t){var n={};v.call(e,function(r){var i=r.name,o=ht.get(i,t);void 0!==o&&(a(e.container[i],o),n[r.name]||(n[r.name]=1))})}}function o(e,t,n){var a=document.createElement(n.toUpperCase());return a.setAttribute("class","form_"+t+"_"+e),a.setAttribute("name",e),a}function s(e){var t=document.createElement("SPAN");return t.className=e,ut(t,y.hideClass),t}function l(e,t){if(t)for(var r in t)e.container[r]||n("field wasn't added",r),void 0!==t[r].defaultVal&&a(e.container[r],t[r].defaultVal)}function c(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),!0):e.attachEvent?e.attachEvent("on"+t,n):(t="on"+t,"function"==typeof e[t]&&(n=function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),e[t]=n,!0)}function u(e,t){if(t)for(var n in t)for(var a in t[n]){var r=null;switch(a){case Y:case $:if(e.container[n].length)for(var i=0;i<e.container[n].length;i++)e.container[n][i].setAttribute(a,"1");else e.container[n].setAttribute(a,"1");break;case W:r=t[n][a];for(var o in r)e.container[n].setAttribute(o,r[o]);break;case P:if(r=t[n][a],"string"==typeof r)ut(e.container[n],r);else try{for(var i=0;i<r.length;i++)ut(e.container[n],r[i])}catch(s){}}}}function f(e){var t=e.getConfig();if(!(t[M]&w))return void(e.submit=function(){e.container.submit.call(e.container)});var n=function(n){var a=t[_]||y.submitCallback,r=t[H]||y.validateCallback,i=t[I]||y.beforeSubmitCallback,o=t[S]||y.afterSubmitCallback,s=t[T]||function(n){n=n||function(){};var i=e.validate();if(r(i),i){var o=e.getFormData();if(t[U])for(var s in t[U])o[s]=t[U][s];return y.ajax(e.action,"POST",o,function(e){return function(t,n){a(t,n,e)}}(n)),e.saveChanges(),!0}return!1};i(function(){s(n)&&o()})};e.container.submit=e.submit=n,c(e.container,"submit",function(e){return e.preventDefault&&e.preventDefault(),n(),e.returnValue=!1,!1})}function d(e,t){if(void 0!==e){var n;if(document.createEvent){if(n=document.createEvent("MouseEvents"),n.initEvent(t,!0,!1),e.length&&void 0==e.name){for(var a=0;a<e.length;a++)e[a].dispatchEvent(n);return}e.dispatchEvent(n)}else if(document.createEventObject){if(n=document.createEventObject(),void 0===e.fireEvent||"function"!=typeof e.fireEvent)return;e.fireEvent("on"+t,n)}}}function h(t){var n=function(t,n,a){switch(a){case Forms.VALIDATION_ON_CHANGE:"blur"==t.type&&this.validate(n);break;case Forms.VALIDATION_ON_KEYUP:this.validate(n)}var r=this.getFormData(),i=this.getConfig()[R]||y.onChange,o=this.getConfig()[j]||function(){},s=ht.get(n,this.valuesCache),l=ht.get(n,r),c=e(this.defaultFormData,r);this.isChanged!=c&&i(c,this),this.isChanged=c,console.log("isDifferent",this.defaultFormData),e(s,l)&&(o(n,l),ht.set(n,l,this.valuesCache))};v.call(this,function(e){if(!e.initialized){var a=function(e){return function(a){n.call(this,a,e,t)}.bind(this)}.call(this,e.name);c(e,"blur",a),c(e,"click",a),c(e,"keyup",a),c(e,"formChange",a),e.initialized=!0}}.bind(this))}function v(e){for(var t=0;t<E.length;t++)for(var n=this.container.getElementsByTagName(E[t]),a=0;a<n.length;a++)e(n[a])}function g(e,t,n){if(void 0==e.allChildren){e.allChildren={};for(var a=e.getElementsByTagName("*"),r=0;r<a.length;r++)e.allChildren[a[r].className]=e.allChildren[a[r].className]||[],e.allChildren[a[r].className].push(a[r])}var i=e.allChildren["form_"+n+"_"+t];return void 0===i?null:1==i.length?i[0]:i[0]?i:null}function m(e,t,n,a,r){function i(e){var t=document.createElement("p");return t.appendChild(e),t.innerHTML}function o(e){switch(e){case"option":case"select":case"textarea":return e;case"text":case"hidden":case"password":case"checkbox":case"radio":return"input";default:return""}}function s(e,t){t=t||!1;var n=null,a=o(e),r=null;switch(e){case"text":case"hidden":case"password":case"checkbox":case"radio":r=e}if(!a)return null;try{n=document.createElement("<"+a+' name="'+t+'" type="'+r+'">')}catch(i){n=document.createElement(a.toUpperCase())}return null!==r&&(n.setAttribute("type",r),n.type=r),t!==!1&&(n.setAttribute("name",t),n.name=t),n}if(a=a||!1,n=n||!1,r=r||y.templateFast,t){var l=e.container;e.errorContainers={},e.warningContainers={},e.fieldContainers={};var c=function(e,t){var n=document.createElement("LABEL");return n.innerHTML=e,n.setAttribute("for",t),n};for(var u in t){var f=u+"",d=t[f],h=d[q];if(h&&(e.fieldContainers[f]=g(l,f,Z),e.fieldContainers[f])){e.fieldContainers[f].innerHTML="",b=n?f+"-"+C++:f;var v=g(l,f,J);if(d.label&&v){v.innerHTML="";var m=c(d.label,b);a&&m.setAttribute("title",f),v.appendChild(m)}var b,p={};d.data?p=d.data:d.label?p[d.label]=null:p[""]=null,e.fieldContainers[f].innerHTML=function(e,t,n,a,r,o){var l=[],u=1,f=0;for(var d in e)f++;var h=f>=2;for(var v in e){var g,m=t+(h?"-"+u:""),b={};"select"==n?(0!=d&&(g=s("option"),g.value="",g.innerHTML="",l.push({input:i(g)}),d=0),g=s("option"),g.innerHTML=v):(g=s(n,a),g.setAttribute("id",m),b.label=r?"":i(c(v,m)));var p=null===e[v]?"":e[v];"textarea"!=n&&(g.setAttribute("value",p),g.value=p),g.setAttribute("error-id",t),b.input=i(g),l.push(b),u++}return o[n]?o[n](a,t,l):l[0].input}(p,b,h,f,!!v,r)}}}}function b(e,t){var n=this.notificationContainers[e];if(void 0===n[t]){var a=g(this.container,t,e);a||(a=o(t,e,this.fieldContainers[t].tagName),this.fieldContainers[t].parentNode.insertBefore(a,this.fieldContainers[t].nextSibling)),a.children.length||a.appendChild(s(this.getConfig()[e+"Class"]||y.classes[e])),n[t]=a}return this.notificationContainers[e][t].children[0]}function p(){v.call(this,function(e){this.setField(e.name,"")}.bind(this))}var C=1,A={},E=["input","textarea","select"],y={hideClass:"h",classes:{error:"error",warning:"warning"},errorClass:"error",warningClass:"warning",templateFast:{select:function(e,t,n){for(var a='<select name="'+e+'" id="'+t+'">',r=0;r<n.length;r++)a+=n[r].input;return a+="</select>"},radio:function(e,t,n){for(var a='<table cellpadding="0" cellspacing="0" class="radio-table">',r=0;r<n.length;r++)a+='<tr><td class="radiobutton">'+n[r].input+'</td><td class="radio_label">'+n[r].label+"</td></tr>";return a+="</table>"},checkbox:function(e,t,n){for(var a='<table cellpadding="0" cellspacing="0" class="radio-table">',r=0;r<n.length;r++)a+='<tr><td class="checkbox">'+n[r].input+'</td><td class="checkbox_label">'+n[r].label+"</td></tr>";return a+="</table>"}},ajax:function(e,t,n,a,r){var i=new XMLHttpRequest;i.open(t,e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(ht.serialize(n,null)),i.onreadystatechange=function(){200==i.status&&4==i.readyState&&a(i.response),200!=i.status&&r()}},onChange:function(){},submitCallback:function(e,t,n){return n(),!0},validateCallback:function(){return!0},beforeSubmitCallback:function(e){return e(),!0},afterSubmitCallback:function(){return!0}},k=1,F=2,N=4,w=8,x="id",L="obj",M="flags",T="onSubmit",I="beforeSubmit",_="submitCallback",S="afterSubmit",D="fields",O="validationType",j="onFieldChange",R="onChange",H="onValidate",V="data",B="templates",U="params",z="action",W="attributes",q="type",G="validate",P="class",$="bitmask",Y="disabled",X="warning",Z="field",K="warning",Q="error",J="label",et="No configuration passed",tt="Form is initialized already",nt="No such element on the page",at=1,rt=2,it=3,ot=2,st=0,lt=1,ct={setWarningMessage:function(e,t){ct.methods[e]||(ct.methods[e]=[]),ct.methods[e][lt]=t},setErrorMessage:function(e,t){ct.methods[e]||(ct.methods[e]=[]),ct.methods[e][st]=t},setTestFunction:function(e,t){ct.methods[e]||(ct.methods[e]=[]),ct.methods[e][ot]=t},set:function(e,t){ct.methods[e]=t},remove:function(e){delete ct.methods[e]},methods:{multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(e,t){return e%t===0}],email:["Wrong email format","Bad email format",function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}],"int":["Must be an integer","Should be an integer",function(e){return parseInt(e,10)==e}],"float":["Must be a decimal","Should be a decimal",function(e){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(e)}],min:["Must be >= {val}","Value is lower than {val}",function(e,t){return(parseFloat(e)||0)>=(parseFloat(t)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(e,t){return(parseFloat(e)||0)<=(parseFloat(t)||0)}],date:["Wrong date format","Bad date format",function(e){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(e)}],length:["Must be {val} characters long","Should be {val} characters long",function(e,t){return e.length==t}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(e,t){return e.length<=t}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(e,t){return e.length<=t}],required:["Required field","This field is highly recommended to fill",function(e){return!(""==e||null==e||void 0==typeof e)}]},hideError:function(e){ut(e,y.hideClass)},showError:function(e,t){e.innerHTML=t,dt(e,y.hideClass)},field:function(e,t,n,a){var r=!0,i=!0,o=e.getConfig(),s=o.errorClass||y.classes.error,l=o.warningClass||y.classes.warning;if(n[G])for(var c in n[G])if(ct.methods[c]){if(("required"==c||""!=a&&null!==a&&void 0!==typeof a)&&(r=ct.methods[c][ot](a,n[G][c])),!r){ct.showError(e.getErrorContainer(t),ct.methods[c][st].supplant({val:n[G][c]})),void 0!==e.container[t].name&&ut(e.container[t],s),i=!1;break}e.notificationContainers[Q][t]&&ct.hideError(e.getErrorContainer(t)),void 0!==e.container[t].name&&dt(e.container[t],s)}if(n[X])for(var c in n[X])if(ct.methods[c])if(i){if(("required"==c||""!=a&&null!==a&&void 0!==typeof a)&&(r=ct.methods[c][ot](a,n[X][c])),!r){console.log("getWarningContainer",t,e.getWarningContainer(t)),ct.showError(e.getWarningContainer(t),ct.methods[c][lt].supplant({val:n[X][c]})),void 0!==e.container[t].name&&ut(e.container[t],l);break}e.notificationContainers[K][t]&&ct.hideError(e.getWarningContainer(t)),void 0!==e.container[t].name&&dt(e.container[t],l)}else e.notificationContainers[K][t]&&ct.hideError(e.getWarningContainer(t));return i},process:function(e,t){var n=e.container,a=e.getFormData(),r=!0;for(var i in t)if(void 0!==n[i]){var o=n[i].name?n[i].name:n[i][0].name;ct.field(e,o,t[i],a[i])===!1&&(r=!1)}return r}},ut=function(e,t){ft(e,t)||(e.className=(e.className+" "+t).trim())},ft=function(e,t){return RegExp("( |^)"+t+"( |$)","g").test(e.className)},dt=function(e,t){var n=RegExp("( |^)"+t+"( |$)","g");e.className=e.className.replace(n,function(e,t,n){return t==n?n:""})},ht={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,serialize:function(e,t){var n=[];for(var a in e){var r=t?t+"["+a+"]":a,i=e[a];n.push("object"==typeof i?ht.serialize(i,r):encodeURIComponent(r)+"="+encodeURIComponent(i))}return n.join("&")},get:function(e,t){for(var n,a=[e.replace(ht.isObjReg,"")];n=ht.allReg.exec(e);)a.push(n[1]);if(void 0===t||void 0===t[a[0]])return void 0;for(var r=t,i=0;i<a.length;i++)if(void 0!==r[a[i]]){if(""==r[a[i]])return r[a[i]];r=r[a[i]]}return r},setVal:function(e,t,n){if(e.length){var a=e.shift(),r=e[0],i=n;if(void 0===r)return""==a?n.push?void n.push(t):!1:void(n[a]=t);""==a&&(i.push||(i=[]),i.push(""==r?[]:{}),a=i.length-1),i=i[a]="object"==typeof i[a]&&null!==i[a]?i[a]:""==r?[]:{},ht.setVal(e,t,i)}},set:function(e,t,n){var a=e.replace(ht.isObjReg,""),r=[];a&&r.push(a);for(var i;i=ht.allReg.exec(e);)r.push(i[1]);ht.setVal(r,t,n)}};return function(e,t){void 0!==window.Element&&(e[t]||(e[t]=function(e){return this.querySelectorAll("."+e)},Element.prototype[t]=e[t]))}(document,"getElementsByClassName"),{Form:function(e){function o(){return c.config}function s(e){return!!e}var c={cache:null,config:e||null,initialized:!1,defaultFormData:null,container:null},g=this;return g.init=function(e){return c.initialized?(n(tt),!1):(s(e)||t(et),c.config=e,c.initialized=!0,!0)},g.isChanged=!1,g.getConfig=o,s(c.config)?(c.config[x]&&(c.container=document.getElementById(c.config[x]),c.container||t(nt,c.config[x]),g.container=c.container),c.config[L]&&(g.container=c.container=c.config[L],c.config[x]=g.container.id),g.getFormData=function(e){return e=e||!!(c.config[M]&N),r(g.container,e)},c.config[z]&&c.container.setAttribute(z,c.config[z]),g.ignoreList={},g.action=c.container.getAttribute("action"),g.setField=function(e,t){a(c.container[e],t),d(c.container[e],"formChange")},g.getField=function(e){return g.container[e]},g.validate=function(e){if(e){var t=g.getFormData();return ct.field(g,e,c.config[D][e],t[e])}return ct.process(g,c.config[D])},g.clear=p.bind(g),g.notificationContainers={},g.notificationContainers[Q]={},g.notificationContainers[K]={},g.getErrorContainer=function(e){return b.call(g,Q,e)},g.getWarningContainer=function(e){return b.call(g,K,e)},g.initInputs=function(){v.call(g,function(e){void 0===e.hasAttribute&&(e.hasAttribute=function(e){return void 0!==this[e]})});for(var e=0,t=0;t<g.container.elements.length;t++){var n=g.container.elements[t];(!n.type||"hidden"!=n.type&&"disabled"!=n.type)&&n.setAttribute("tabindex",++e)}h.call(g,c.config[O]||Forms.VALIDATION_ON_SUBMIT)},g.saveChanges=function(){g.defaultFormData=g.getFormData(),(c.config[R]||y.onChange)(!1,g),g.isChanged=!1},m(g,c.config[D],!!(c.config[M]&k),!!(c.config[M]&F),c.config[B]),g.initInputs(),l(g,c.config[D]),u(g,c.config[D]),c.config[V]&&i(g,c.config[V]),g.valuesCache=g.getFormData(),f(g),g.saveChanges(),c.config[O]===it&&g.validate(),g.remove=function(){Forms.remove(c.config[x])},g.remove(),void(A[c.config[x]]=g)):void n(et)},VALIDATION_ON_SUBMIT:at,VALIDATION_ON_CHANGE:rt,VALIDATION_ON_KEYUP:it,FLAG_DEBUG:F,FLAG_SUBMIT_EMPTY:N,FLAG_UNIQUE_LABELS:k,FLAG_ASYNC:w,defaults:y,remove:function(e){A[e]&&delete A[e]},validation:{setWarningMessage:ct.setWarningMessage,setErrorMessage:ct.setErrorMessage,setTestFunction:ct.setTestFunction,set:ct.set,remove:ct.remove},getList:function(){return A}}}();