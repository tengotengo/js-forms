Forms=function(){function e(){throw Error(Array.prototype.slice.call(arguments).join(", "))}function t(){console.log(Array.prototype.slice.call(arguments).join(", "))}function n(e){if(!(e.config[O]&E))return void(e.submit=function(t){e.container.submit(t)});var t=function(){var t=arguments[arguments.length-1],n="function"==typeof t?t:function(){},a=e.config[N]||e.defaults.submitCallback,i=e.config[V]||e.defaults.validateCallback,r=e.config[F]||e.defaults.beforeSubmitCallback,o=e.config[j]||e.defaults.afterSubmitCallback,l=e.config[S]||function(t){t=t||function(){};var n=e.validate();if(i(n),n){var r=e.getFormData();if(e.config[P])for(var o in e.config[P])r[o]=e.config[P][o];return e.defaults.ajax(e.action,"POST",r,function(t){return function(n,i){a.call(e,n,i,t)}}(t)),e.saveChanges(),!0}return!1};r(function(){l(n)&&o()})};e.container.submit=e.submit=t,m(e.container,"submit",function(e){return e.preventDefault&&e.preventDefault(),t(),e.returnValue=!1,!1})}function a(e,t,n,a){var i="";switch(e){case"select":i='<select name="'+t+'" id="'+n+'">';for(var r,o=0;r=a[o];o++)i+=r.input;i+="</select>";break;case"radio":case"checkbox":i='<table cellpadding="0" cellspacing="0" class="forms-'+e+'-table">';for(var r,o=0;r=a[o];o++)i+='<tr><td class="forms-'+e+'">'+r.input+'</td><td class="forms-label-'+e+'">'+r.label+"</td></tr>";i+="</table>";break;default:return!1}return i}function i(e,t){var n={};if(!e.length)return n;for(var a,i=0;a=e[i];i++){var r=a.name,o=function(e){var t=e.name,n=e.type,a=e.tagName.toLowerCase();if(!t||e.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==a&&-1==e.selectedIndex)return null;switch(a){case"select":var i=e.selectedIndex;if(0>i)return null;for(var r=[],o=e.options,l="select-one"==n,s=l?i+1:o.length,c=l?i:0;s>c;c++){var u=o[c];if(u.selected){var f=u.value;if(f||(f=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),l)return f;r.push(f)}}return r;case"input":switch(n){case"radio":return""===e.value?null:e.value;case"checkbox":return e.hasAttribute("value")?""===e.value?1:e.value:1;case"text":case"password":case"hidden":return""===e.value?null:e.value}break;case"textarea":return""===e.value?null:e.value}return!1};if(r&&!a.disabled&&!c(a,"default-text")){var l=o(a);t&&void 0===ft.get(r,n)&&null===l&&ft.set(r,null,n),null!==l&&(t||""!==l&&null!==l&&void 0!==l)&&(a.hasAttribute("bitmask")?(l=parseInt(l,10)||0,(0!==l||t)&&(n[r]|=l)):ft.set(r,l,n))}}return n}function r(e,t){if(e){var n=function(e,t){var n=e.tagName.toLowerCase();switch(n){case"select":for(var a,i=e.children,r=!1,o=0;a=i[o];o++)t!=a.value?(a.removeAttribute("selected"),a.selected=!1):(a.setAttribute("selected","1"),a.selected=!0,r=o);e.selectedIndex=r===!1?-1:r;break;case"input":switch(e.type){case"radio":t==e.value?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1);break;case"password":case"hidden":case"text":"object"==typeof t?(e.setAttribute("value",t),e.value=t):(e.setAttribute("value",t),e.value=t);break;case"checkbox":var l=e.hasAttribute("bitmask");l&&e.value&t||t&&"0"!==t&&"!1"!==t&&!l?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1)}break;case"textarea":e.innerHTML=t,e.value=t}};if("object"==typeof t&&e.length)for(var a,i=0;a=e[i];i++)n(a,null!==t&&t[i]?t[i]:null);else if(!e.length||e.tagName)n(e,t);else for(var a,i=0;a=e[i];i++)n(a,t)}}function o(e,t){if(void 0!==e){var n;if(document.createEvent){if(n=document.createEvent("MouseEvents"),n.initEvent(t,!0,!1),e.length&&void 0==e.name){for(var a=0;a<e.length;a++)e[a].dispatchEvent(n);return}e.dispatchEvent(n)}else if(document.createEventObject){if(n=document.createEventObject(),void 0===e.fireEvent||"function"!=typeof e.fireEvent)return;e.fireEvent("on"+t,n)}}}function l(e){return ut[e]?ut[e]:!1}function s(e,t){c(e,t)||(e.className=(e.className+" "+t).trim())}function c(e,t){return RegExp("( |^)"+t+"( |$)","g").test(e.className)}function u(e,t){var n=RegExp("( |^)"+t+"( |$)","g");e.className=e.className.replace(n,function(e,t,n){return t==n?n:""})}function f(e){var t=!this.elements;t&&(this.elements={});for(var n,a=0;n=this.container[a];a++)t&&(this.elements[n.name]?"[object Array]"===Object.prototype.toString.call(this.elements[n.name])?this.elements[n.name].push(n):this.elements[n.name]=Array.prototype.concat(this.elements[n.name],n):this.elements[n.name]=n),e(n)}function d(){f.call(this,function(e){this.setField(e.name,"")}.bind(this))}function h(e,t,n){var a=document.createElement(n.toUpperCase());return a.setAttribute("class","form_"+t+"_"+e),a.setAttribute("name",e),a}function v(e,t){var n=document.createElement("SPAN");return n.className=e,s(n,t),n}function g(e,t,n){var a=this.notificationContainers[e];if(void 0===a[t]){var i=b(this.container,t,e);if(!i){if(!this.fieldContainers[t])return;i=h(t,e,this.fieldContainers[t].tagName),this.fieldContainers[t].parentNode.insertBefore(i,this.fieldContainers[t].nextSibling)}i.children.length||i.appendChild(v(n,this.options.defaults.hideClass)),a[t]=i}return this.notificationContainers[e][t].children[0]}function m(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),!0):e.attachEvent?e.attachEvent("on"+t,n):(t="on"+t,"function"==typeof e[t]&&(n=function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),e[t]=n,!0)}function b(e,t,n){var a;if(!e.allChildren){e.allChildren={};for(var i,r=e.getElementsByTagName("*"),o=0;i=r[o];o++)e.allChildren[i.className]=e.allChildren[i.className]||[],e.allChildren[i.className].push(i)}return a=e.allChildren["form_"+n+"_"+t],a?a&&void 0===a.length?a:1==a.length?a[0]:a[0]?a:null:null}function p(e,t,n,i){if(i=i||!1,n=n||!1,t){var r=e.container;e.errorContainers={},e.warningContainers={},e.fieldContainers={};var o=function(e,t){var n=document.createElement("LABEL");return n.innerHTML=e,n.setAttribute("for",t),n};for(var l in t){var s=l+"",c=t[s],u=c[H];if(u&&(e.fieldContainers[s]=b(r,s,X),e.fieldContainers[s])){e.fieldContainers[s].innerHTML="",h=n?s+"-"+st++:s;var f=b(r,s,K);if(c.label&&f){f.innerHTML="";var d=o(c.label,h);i&&d.setAttribute("title",s),f.appendChild(d)}var h,v={};c.data?v=c.data:c.label?v[c.label]=null:v[""]=null,e.fieldContainers[s].innerHTML=function(e,t,n,i,r){var o=[],l=1,s=0;for(var c in e)s++;var u=s>=2;for(var f in e){var d,h=t+(u?"-"+l:""),v={},g=null===e[f]?"":e[f];"select"==n?(0!==c&&(d='<option value=""></option>',o.push({input:d}),c=0),d='<option value="'+g+'">'+f+"</option>"):(d="text"==n||"hidden"==n||"password"==n||"checkbox"==n||"radio"==n?'<input type="'+n+'" name="'+i+'" id="'+h+'" error-id="'+t+'" value="'+g+'" />':'<textarea name="'+i+'" id="'+h+'" error-id="'+t+'" >'+g+"</textarea>",v.label=r?"":'<label for="'+h+'">'+f+"</label>"),v.input=d,o.push(v),l++}var m=a(n,i,t,o);return m?m:o[0].input}(v,h,u,s,!!f)}}}}function C(a){function c(a){function l(e){return!!e}var c={cache:null,formDataCache:null,config:null,defaults:h,initialized:!1,container:null},u=this;if(c.config=c.config||a,u.init=function(n){return c.initialized?(t(J),!1):(l(n)||e(Q),c.config=n,c.initialized=!0,!0)},u.isChanged=!1,u.differsObj={},u.prevValues={},u.valuesCache={},u.lastChangedStatus=!1,u.config=c.config,u.options=c,u.defaults=h,!l(c.config))return void t(Q);if(c.config[w]&&(c.container=document.getElementById(c.config[w]),c.container||e(et,c.config[w]),u.container=c.container),c.config[x]&&(u.container=c.container=c.config[x],c.config[w]=u.container.getAttribute("id")),u.container){c.config[O]=c.config[O]?c.config[O]|h.flags:h.flags,c.config[I]||(c.config[I]=h.validationType),console.log("opt.config[PARAM_FLAGS]",c.config[O]);var b=!!(c.config[O]&k);u.getFormData=function(e){return!c.formDataCache||u.isChanged||e?(c.formDataCache=i(u.container,b),c.formDataCache):cloneObject(c.formDataCache)},c.config[z]&&c.container.setAttribute(z,c.config[z]),u.action=c.container.getAttribute("action"),u.setField=function(e,t){u.elements[e]&&(r(u.elements[e],t),o(u.elements[e],"formChange"))},u.setFields=function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&u.elements[t]&&(r(u.elements[t],e[t]),o(u.elements[t],"formChange"));u.getFormData(!0)},u.getField=function(e){return u.elements[e]},u.validate=function(e){if(e){var t=u.getFormData(!0);return v.field(u,e,u.config[L][e],t[e],h.errorClass,h.warningClass)}return u.config[_]?u.config[_](u,u.getFormData(1)):v.process(u,c.config[L])},u.clear=d.bind(u),u.notificationContainers={},u.notificationContainers[Z]={},u.notificationContainers[Y]={},u.getErrorContainer=function(e){return g.call(u,Z,e,h.errorClass)},u.getWarningContainer=function(e){return g.call(u,Y,e,h.warningClass)},u.initInputs=function(){var e=c.config[L]||{},t=c.config[R],n=c.config[I],a=this.config[T]||h.onChange,i=this.config[D]||function(){console.log("fieldChange fired",arguments)},o=function(e,t,n){var r=ft.get(t,this.prevValues),o=ft.get(t,this.valuesCache),l=ft.get(t,this.getFieldValue(t));switch(n){case nt:"blur"==e.type&&this.validate(t);break;case at:this.validate(t);break;case tt:ft.set(t,l,this.options.formDataCache)}differs(o,l)?ft.set(t,!0,this.differsObj):ft.del(t,this.differsObj),this.isChanged=differs(this.differsObj,{}),this.isChanged!=this.lastChangedStatus&&(a(this.isChanged,this),this.lastChangedStatus=!!this.isChanged),differs(r,l)&&(i(t,l),ft.set(t,l,this.prevValues))};f.call(u,function(a){void 0===a.hasAttribute&&(a.hasAttribute=function(e){return void 0!==this[e]}),function(){(!a.type||"hidden"!=a.type&&"disabled"!=a.type)&&(a.setAttribute("tabindex",++lt),a.formIndex=a.formIndex||lt)}();var i=a.name,l=ft.get(i,t);if(e[i]){void 0!==e[i].defaultVal&&void 0===l&&(r(a,e[i].defaultVal),ft.set(i,e[i].defaultVal,u.prevValues));for(var c in e[i]){var f=null;switch(c){case W:case G:if(a.length)for(var d,h=0;d=a[h];h++)d.setAttribute(c,"1");else a.setAttribute(c,"1");break;case B:f=e[i][c];for(var v in f)a.setAttribute(v,f[v]);break;case q:if(f=e[i][c],"string"==typeof f)s(a,f);else try{for(var h=0;h<f.length;h++)s(a,f[h])}catch(g){}}}}if(void 0!==l&&null!==l&&(r(a,l),ft.set(i,l,u.prevValues)),!a.initialized){var b=function(e){return function(t){o.call(this,t,e,n)}.bind(this)}.call(u,a.name);m(a,"blur",b),m(a,"click",b),m(a,"keyup",b),m(a,"formChange",b),a.initialized=!0}})},u.saveChanges=function(){u.differsObj={},u.lastChangedStatus=!1,u.prevValues=u.getFormData(),u.valuesCache=u.getFormData(),(c.config[T]||h.onChange)(!1,u),u.isChanged=!1},p(u,c.config[L],!!(c.config[O]&y),!!(c.config[O]&A)),u.getFieldValue=function(e){return u.elements[e]?i(Array.prototype.concat(u.elements[e]),b):void 0},u.initInputs(),c.config[M]&&c.config[M](u),n(u),u.saveChanges(),c.config[I]===at&&u.validate(),u.remove=function(){Forms.remove(c.config[w])},u.remove(),ct[c.config[w]]=u}}var h={flags:a.flags||0,validationType:a.validationType||Forms.VALIDATION_ON_SUBMIT,hideClass:a.hideClass||"h",errorClass:a.errorClass||"error",warningClass:a.warningClass||"warning",ajax:a.ajax||function(e,t,n,a,i){var r=new XMLHttpRequest;i=i||function(){},r.open(t,e),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(ft.serialize(n,null)),r.onreadystatechange=function(){200==r.status&&4==r.readyState&&a(r.status,r.response),200!=r.status&&i()}},onChange:a.onChange||function(){},formContext:a.formContext||function(){},fieldContext:a.fieldContext||function(){},submitCallback:a.submitCallback||function(e,t,n){return n(),!0},validateCallback:a.validateCallback||function(){return!0},beforeSubmitCallback:a.beforeSubmitCallback||function(e){return e(),!0},afterSubmitCallback:a.afterSubmitCallback||function(){return!0}},v={methods:{},hideError:function(e){e&&s(e,h.hideClass)},showError:function(e,t){e&&(e.innerHTML=t,u(e,h.hideClass))},field:function(e,t,n,a,i,r){var o=!0,c=!0;if(n[U])for(var f in n[U])if(Object.prototype.hasOwnProperty.call(n[U],f)){var d=v.methods[f]||l(f);if(d){if(("required"==f||""!=a&&null!==a&&void 0!==a)&&(o=d[it](a,n[U][f])),!o){v.showError(e.getErrorContainer(t),d[rt].supplant({val:n[U][f]})),e.elements[t]&&void 0!==e.elements[t].name&&s(e.elements[t],i),c=!1,console.log(t,"is not valid");break}e.notificationContainers[Z][t]&&v.hideError(e.getErrorContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&u(e.elements[t],i)}}if(n[$])for(var f in n[$])if(Object.prototype.hasOwnProperty.call(n[$],f)){var d=v.methods[f]||l(f);if(d)if(c){if(("required"==f||""!=a&&null!==a&&void 0!==a)&&(o=d[it](a,n[$][f])),!o){v.showError(e.getWarningContainer(t),d[ot].supplant({val:n[$][f]})),e.elements[t]&&void 0!==e.elements[t].name&&s(e.elements[t],r);break}e.notificationContainers[Y][t]&&v.hideError(e.getWarningContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&u(e.elements[t],r)}else e.notificationContainers[Y][t]&&v.hideError(e.getWarningContainer(t))}return c},process:function(e,t){var n=e.getFormData(1),a=!0;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i][U]||t[i][$])&&(v.field(e,i,t[i],n[i],h.errorClass,h.warningClass)||(a=!1));return a}};if(a.validation)for(var b in a.validation)Object.prototype.hasOwnProperty.call(a.validation,b)&&(v.methods[b]=a.validation[b]);this.create=c}var y=1,A=2,k=4,E=8,w="id",x="obj",O="flags",S="onSubmit",F="beforeSubmit",N="submitCallback",j="afterSubmit",L="fields",I="validationType",D="onFieldChange",T="onChange",M="onInit",V="onValidate",_="validate",R="data",P="params",z="action",B="attributes",H="type",U="validate",q="class",G="bitmask",W="disabled",$="warning",X="field",Y="warning",Z="error",K="label",Q="No configuration passed",J="Form is initialized already",et="No such element on the page",tt=1,nt=2,at=3,it=2,rt=0,ot=1,lt=0,st=1,ct={},ut={multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(e,t){return e%t===0}],email:["Wrong email format","Bad email format",function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}],"int":["Must be an integer","Should be an integer",function(e){return parseInt(e,10)==e}],"float":["Must be a decimal","Should be a decimal",function(e){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(e)}],min:["Must be >= {val}","Value is lower than {val}",function(e,t){return(parseFloat(e)||0)>=(parseFloat(t)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(e,t){return(parseFloat(e)||0)<=(parseFloat(t)||0)}],date:["Wrong date format","Bad date format",function(e){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(e)}],length:["Must be {val} characters long","Should be {val} characters long",function(e,t){return e.length==t}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(e,t){return e.length<=t}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(e,t){return e.length<=t}],required:["Required field","This field is highly recommended to fill",function(e){return!(""==e||null==e||void 0===e)}]},ft={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,getPath:function(e){var t=e.replace(ft.isObjReg,""),n=[];t&&n.push(t);for(var a;a=ft.allReg.exec(e);)n.push(a[1]);return n},serialize:function(e,t){var n=[];for(var a in e){var i=t?t+"["+a+"]":a,r=e[a];n.push("object"==typeof r&&null!==r?ft.serialize(r,i):encodeURIComponent(i)+"="+(null===r?"":encodeURIComponent(r)))}return n.join("&")},getOrDel:function(e,t,n){var a=this.getPath(e);if(void 0===t||void 0===t[a[0]])return void 0;for(var i,r,o=t,l=0;l<a.length;l++)if(void 0!==o[a[l]]){if(""==o[a[l]])return n?delete o[a[l]]:o[a[l]];i=o,r=a[l],o=o[a[l]]}return n?delete i[r]:o},del:function(e,t){return this.getOrDel(e,t,!0)},get:function(e,t){return this.getOrDel(e,t)},setVal:function(e,t,n){if(e.length){var a=e.shift(),i=e[0],r=n;if(void 0===i){if(""==a)return n.push?void n.push(t):!1;if(void 0===n)return;return void(n[a]=t)}""==a&&(r.push||(r=[]),r.push(""==i?[]:{}),a=r.length-1),r=r[a]="object"==typeof r[a]&&null!==r[a]?r[a]:""==i?[]:{},ft.setVal(e,t,r)}},set:function(e,t,n){var a=this.getPath(e);ft.setVal(a,t,n)}};return function(e,t){void 0!==window.Element&&(e[t]||(e[t]=function(e){return this.querySelectorAll("."+e)},Element.prototype[t]=e[t]))}(document,"getElementsByClassName"),{Form:C,remove:function(e){ct[e]&&delete ct[e]},getList:function(){return ct},VALIDATION_ON_SUBMIT:tt,VALIDATION_ON_CHANGE:nt,VALIDATION_ON_KEYUP:at,FLAG_DEBUG:A,FLAG_SUBMIT_EMPTY:k,FLAG_UNIQUE_LABELS:y,FLAG_ASYNC:E}}();