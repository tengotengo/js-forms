Forms=function(){function Z(){throw new Error(Array.prototype.slice.call(arguments).join(", "))}function $(){console.log(Array.prototype.slice.call(arguments).join(", "))}function _(a){if(!(a.config[h]&d))return a.submit=function(b){a.container.submit(b)},void 0;var b=function(){var b=arguments[arguments.length-1],c="function"==typeof b?b:function(){},d=a.config[k]||a.defaults.submitCallback,e=a.config[u]||a.defaults.validateCallback,f=a.config[j]||a.defaults.beforeSubmitCallback,g=a.config[o]||a.defaults.afterSubmitCallback,h=a.config[i]||function(b){b=b||function(){};var c=a.validate();if(e(c),c){var f=a.getFormData();if(a.config[y])for(var g in a.config[y])f[g]=a.config[y][g];return a.defaults.ajax(a.action,"POST",f,function(b){return function(c,e){d.call(a,c,e,b)}}(b)),a.saveChanges(),!0}return!1};f(function(){h(c)&&g()})};a.container.submit=a.submit=b,nb(a.container,"submit",function(a){return a.preventDefault&&a.preventDefault(),b(),a.returnValue=!1,!1})}function ab(a,b,c,d){var e="";switch(a){case"select":e='<select name="'+b+'" id="'+c+'">';for(var g,f=0;g=d[f];f++)e+=g.input;e+="</select>";break;case"radio":case"checkbox":e='<table cellpadding="0" cellspacing="0" class="forms-'+a+'-table">';for(var g,f=0;g=d[f];f++)e+="<tr><td>"+g.input+"</td>"+"<td>"+g.label+"</td>"+"</tr>";e+="</table>";break;default:return!1}return e}function bb(a,b){var c={};if(!a.length)return c;for(var e,d=0;e=a[d];d++){var f=e.name,g=function(a){var b=a.name,c=a.type,d=a.tagName.toLowerCase();if(!b||a.disabled||"reset"==c||"button"==c||("checkbox"==c||"radio"==c)&&!a.checked||("submit"==c||"image"==c)&&a.form&&a.form.clk!=a||"select"==d&&-1==a.selectedIndex)return null;switch(d){case"select":var e=a.selectedIndex;if(0>e)return null;for(var f=[],g=a.options,h="select-one"==c,i=h?e+1:g.length,j=h?e:0;i>j;j++){var k=g[j];if(k.selected){var l=k.value;if(l||(l=k.attributes&&k.attributes.value&&!k.attributes.value.specified?k.text:k.value),h)return l;f.push(l)}}return f;case"input":switch(c){case"radio":return""===a.value?null:a.value;case"checkbox":return a.hasAttribute("value")?""===a.value?1:a.value:1;case"text":case"password":case"hidden":return""===a.value?null:a.value}break;case"textarea":return""===a.value?null:a.value}return!1};if(f&&!e.disabled&&!gb(e,"default-text")){var h=g(e);b&&void 0===Y.get(f,c)&&null===h&&Y.set(f,null,c),null!==h&&(b||""!==h&&null!==h&&void 0!==h)&&(e.hasAttribute("bitmask")?(h=parseInt(h,10)||0,(0!==h||b)&&(c[f]|=h)):Y.set(f,h,c))}}return c}function cb(a,b){if(a){var c=function(a,b){var c=a.tagName.toLowerCase();switch(c){case"select":for(var g,d=a.children,e=!1,f=0;g=d[f];f++)b!=g.value?(g.removeAttribute("selected"),g.selected=!1):(g.setAttribute("selected","1"),g.selected=!0,e=f);a.selectedIndex=e===!1?-1:e;break;case"input":switch(a.type){case"radio":b==a.value?(a.setAttribute("checked","true"),a.checked=!0):(a.removeAttribute("checked"),a.checked=!1);break;case"password":case"hidden":case"text":"object"==typeof b?(a.setAttribute("value",b),a.value=b):(a.setAttribute("value",b),a.value=b);break;case"checkbox":var h=a.hasAttribute("bitmask");h&&a.value&b||b&&"0"!==b&&"!1"!==b&&!h?(a.setAttribute("checked","true"),a.checked=!0):(a.removeAttribute("checked"),a.checked=!1)}break;case"textarea":a.innerHTML=b,a.value=b}};if("object"==typeof b&&a.length)for(var e,d=0;e=a[d];d++)c(e,null!==b&&b[d]?b[d]:null);else if(!a.length||a.tagName)c(a,b);else for(var e,d=0;e=a[d];d++)c(e,b)}}function db(a,b){if(void 0!==a){var c;if(document.createEvent){if(c=document.createEvent("MouseEvents"),c.initEvent(b,!0,!1),a.length&&void 0==a.name){for(var d=0;d<a.length;d++)a[d].dispatchEvent(c);return}a.dispatchEvent(c)}else if(document.createEventObject){if(c=document.createEventObject(),void 0===a.fireEvent||"function"!=typeof a.fireEvent)return;a.fireEvent("on"+b,c)}}}function eb(a){return X[a]?X[a]:!1}function fb(a,b){gb(a,b)||(a.className=(a.className+" "+b).trim())}function gb(a,b){return new RegExp("( |^)"+b+"( |$)","g").test(a.className)}function hb(a,b){var c=new RegExp("( |^)"+b+"( |$)","g");a.className=a.className.replace(c,function(a,b,c){return b==c?c:""})}function ib(a){var b=!this.elements;b&&(this.elements={});for(var d,c=0;d=this.container[c];c++)b&&(this.elements[d.name]?"[object Array]"===Object.prototype.toString.call(this.elements[d.name])?this.elements[d.name].push(d):this.elements[d.name]=Array.prototype.concat(this.elements[d.name],d):this.elements[d.name]=d),a(d)}function jb(){ib.call(this,function(a){this.setField(a.name,"")}.bind(this))}function kb(a,b,c){var d=document.createElement(c.toUpperCase());return d.setAttribute("class","form_"+b+"_"+a),d.setAttribute("name",a),d}function lb(a,b){var c=document.createElement("SPAN");return c.className=a,fb(c,b),c}function mb(a,b,c){var d=this.notificationContainers[a];if(void 0===d[b]){var e=ob(this.container,b,a);if(!e){if(!this.fieldContainers[b])return;e=kb(b,a,this.fieldContainers[b].tagName),this.fieldContainers[b].parentNode.insertBefore(e,this.fieldContainers[b].nextSibling)}e.children.length||e.appendChild(lb(c,this.options.defaults.hideClass)),d[b]=e}return this.notificationContainers[a][b].children[0]}function nb(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),!0):a.attachEvent?a.attachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(c=function(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}(a[b],c)),a[b]=c,!0)}function ob(a,b,c){var d;if(!a.allChildren){a.allChildren={};for(var g,e=a.getElementsByTagName("*"),f=0;g=e[f];f++)a.allChildren[g.className]=a.allChildren[g.className]||[],a.allChildren[g.className].push(g)}return d=a.allChildren["form_"+c+"_"+b],d?d&&void 0===d.length?d:1==d.length?d[0]:d[0]?d:null:null}function pb(a,b,c,d){if(d=d||!1,c=c||!1,b){var e=a.container;a.errorContainers={},a.warningContainers={},a.fieldContainers={};var f=function(a,b){var c=document.createElement("LABEL");return c.innerHTML=a,c.setAttribute("for",b),c};for(var g in b){var h=g+"",i=b[h],j=i[B];if(j&&(a.fieldContainers[h]=ob(e,h,H),a.fieldContainers[h])){a.fieldContainers[h].innerHTML="",m=c?h+"-"+V++:h;var k=ob(e,h,K);if(i.label&&k){k.innerHTML="";var l=f(i.label,m);d&&l.setAttribute("title",h),k.appendChild(l)}var m,n={};i.data?n=i.data:i.label?n[i.label]=null:n[""]=null,a.fieldContainers[h].innerHTML=function(a,b,c,d,e){var f=[],g=1,h=0;for(var i in a)h++;var j=h>=2;for(var k in a){var m,l=b+(j?"-"+g:""),n={},o=null===a[k]?"":a[k];"select"==c?(0!==i&&(m='<option value=""></option>',f.push({input:m}),i=0),m='<option value="'+o+'">'+k+"</option>"):(m="text"==c||"hidden"==c||"password"==c||"checkbox"==c||"radio"==c?'<input type="'+c+'" name="'+d+'" id="'+l+'" error-id="'+b+'" value="'+o+'" />':'<textarea name="'+d+'" id="'+l+'" error-id="'+b+'" >'+o+"</textarea>",n.label=e?"":'<label for="'+l+'">'+k+"</label>"),n.input=m,f.push(n),g++}var p=ab(c,d,b,f);return p?p:f[0].input}(n,m,j,h,!!k)}}}}function qb(d){function k(d){function l(a){return!!a}var j={cache:null,formDataCache:null,config:null,defaults:g,initialized:!1,container:null},k=this;if(j.config=j.config||d,k.init=function(a){return j.initialized?($(M),!1):(l(a)||Z(L),j.config=a,j.initialized=!0,!0)},k.isChanged=!1,k.differsObj={},k.prevValues={},k.valuesCache={},k.lastChangedStatus=!1,k.config=j.config,k.options=j,k.defaults=g,!l(j.config))return $(L),void 0;if(j.config[e]&&(j.container=document.getElementById(j.config[e]),j.container||Z(N,j.config[e]),k.container=j.container),j.config[f]&&(k.container=j.container=j.config[f],j.config[e]=k.container.getAttribute("id")),k.container){j.config[h]=j.config[h]?j.config[h]|g.flags:g.flags,console.log("opt.config[PARAM_FLAGS]",j.config[h]);var m=!!(j.config[h]&c);k.getFormData=function(a){return!j.formDataCache||k.isChanged||a?(j.formDataCache=bb(k.container,m),j.formDataCache):cloneObject(j.formDataCache)},j.config[z]&&j.container.setAttribute(z,j.config[z]),k.action=j.container.getAttribute("action"),k.setField=function(a,b){k.elements[a]&&(cb(k.elements[a],b),db(k.elements[a],"formChange"))},k.getField=function(a){return k.elements[a]},k.validate=function(a){if(a){var b=k.getFormData(!0);return i.field(k,a,k.config[p][a],b[a],g.errorClass,g.warningClass)}return k.config[v]?k.config[v](k,k.getFormData(1)):i.process(k,j.config[p])},k.clear=jb.bind(k),k.notificationContainers={},k.notificationContainers[J]={},k.notificationContainers[I]={},k.getErrorContainer=function(a){return mb.call(k,J,a,g.errorClass)},k.getWarningContainer=function(a){return mb.call(k,I,a,g.warningClass)},k.initInputs=function(){var a=j.config[p]||{},b=j.config[w],c=j.config[q]||O,d=this.config[s]||g.onChange,e=this.config[r]||function(){console.log("fieldChange fired",arguments)},f=function(a,b,c){switch(c){case P:"blur"==a.type&&this.validate(b);break;case Q:this.validate(b);break;case O:this.getFormData(!0)}var f=Y.get(b,this.valuesCache),g=Y.get(b,this.getFieldValue(b)),h=Y.get(b,this.prevValues);differs(f,g)?Y.set(b,!0,this.differsObj):Y.del(b,this.differsObj),this.isChanged=differs(this.differsObj,{}),this.isChanged!=this.lastChangedStatus&&(d(this.isChanged,this),this.lastChangedStatus=!!this.isChanged),differs(h,g)&&(e(b,g),Y.set(b,g,this.prevValues))};ib.call(k,function(d){void 0===d.hasAttribute&&(d.hasAttribute=function(a){return"undefined"!=typeof this[a]}),function(){(!d.type||"hidden"!=d.type&&"disabled"!=d.type)&&(d.setAttribute("tabindex",++U),d.formIndex=d.formIndex||U)}();var e=d.name,g=Y.get(e,b);if(a[e]){void 0!==a[e].defaultVal&&void 0===g&&(cb(d,a[e].defaultVal),Y.set(e,a[e].defaultVal,k.prevValues));for(var h in a[e]){var i=null;switch(h){case F:case E:if(d.length)for(var l,j=0;l=d[j];j++)l.setAttribute(h,"1");else d.setAttribute(h,"1");break;case A:i=a[e][h];for(var m in i)d.setAttribute(m,i[m]);break;case D:if(i=a[e][h],"string"==typeof i)fb(d,i);else try{for(var j=0;j<i.length;j++)fb(d,i[j])}catch(n){}}}}if(void 0!==g&&null!==g&&(cb(d,g),Y.set(e,g,k.prevValues)),!d.initialized){var o=function(a){return function(b){f.call(this,b,a,c)}.bind(this)}.call(k,d.name);nb(d,"blur",o),nb(d,"click",o),nb(d,"keyup",o),nb(d,"formChange",o),d.initialized=!0}})},k.saveChanges=function(){k.differsObj={},k.lastChangedStatus=!1,k.prevValues=k.getFormData(),k.valuesCache=k.getFormData(),(j.config[s]||g.onChange)(!1,k),k.isChanged=!1},pb(k,j.config[p],!!(j.config[h]&a),!!(j.config[h]&b)),k.getFieldValue=function(a){return k.elements[a]?bb(Array.prototype.concat(k.elements[a]),m):void 0},k.initInputs(),j.config[t]&&j.config[t](k),_(k),k.saveChanges(),j.config[q]===Q&&k.validate(),k.remove=function(){Forms.remove(j.config[e])},k.remove(),W[j.config[e]]=k}}var g={flags:d.flags||0,hideClass:d.hideClass||"h",errorClass:d.errorClass||"error",warningClass:d.warningClass||"warning",ajax:d.ajax||function(a,b,c,d,e){var f=new XMLHttpRequest;e=e||function(){},f.open(b,a),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.send(Y.serialize(c,null)),f.onreadystatechange=function(){200==f.status&&4==f.readyState&&d(f.response),200!=f.status&&e()}},onChange:d.onChange||function(){},formContext:d.formContext||function(){},fieldContext:d.fieldContext||function(){},submitCallback:d.submitCallback||function(a,b,c){return c(),!0},validateCallback:d.validateCallback||function(){return!0},beforeSubmitCallback:d.beforeSubmitCallback||function(a){return a(),!0},afterSubmitCallback:d.afterSubmitCallback||function(){return!0}},i={methods:{},hideError:function(a){a&&fb(a,g.hideClass)},showError:function(a,b){a&&(a.innerHTML=b,hb(a,g.hideClass))},field:function(a,b,c,d,e,f){var g=!0,h=!0;if(c[C])for(var j in c[C])if(Object.prototype.hasOwnProperty.call(c[C],j)){var k=i.methods[j]||eb(j);if(k){if(("required"==j||""!=d&&null!==d&&"undefined"!=typeof d)&&(g=k[R](d,c[C][j])),!g){i.showError(a.getErrorContainer(b),k[S].supplant({val:c[C][j]})),a.elements[b]&&void 0!==a.elements[b].name&&fb(a.elements[b],e),h=!1,console.log(b,"is not valid");break}a.notificationContainers[J][b]&&i.hideError(a.getErrorContainer(b)),a.elements[b]&&void 0!==a.elements[b].name&&hb(a.elements[b],e)}}if(c[G])for(var j in c[G])if(Object.prototype.hasOwnProperty.call(c[G],j)){var k=i.methods[j]||eb(j);if(k)if(h){if(("required"==j||""!=d&&null!==d&&"undefined"!=typeof d)&&(g=k[R](d,c[G][j])),!g){i.showError(a.getWarningContainer(b),k[T].supplant({val:c[G][j]})),a.elements[b]&&void 0!==a.elements[b].name&&fb(a.elements[b],f);break}a.notificationContainers[I][b]&&i.hideError(a.getWarningContainer(b)),a.elements[b]&&void 0!==a.elements[b].name&&hb(a.elements[b],f)}else a.notificationContainers[I][b]&&i.hideError(a.getWarningContainer(b))}return h},process:function(a,b){var c=a.getFormData(1),d=!0;for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(b[e][C]||b[e][G])&&(i.field(a,e,b[e],c[e],g.errorClass,g.warningClass)||(d=!1));return d}};if(d.validation)for(var j in d.validation)Object.prototype.hasOwnProperty.call(d.validation,j)&&(i.methods[j]=d.validation[j]);this.create=k}var a=1,b=2,c=4,d=8,e="id",f="obj",h="flags",i="onSubmit",j="beforeSubmit",k="submitCallback",o="afterSubmit",p="fields",q="validationType",r="onFieldChange",s="onChange",t="onInit",u="onValidate",v="validate",w="data",y="params",z="action",A="attributes",B="type",C="validate",D="class",E="bitmask",F="disabled",G="warning",H="field",I="warning",J="error",K="label",L="No configuration passed",M="Form is initialized already",N="No such element on the page",O=1,P=2,Q=3,R=2,S=0,T=1,U=0,V=1,W={},X={multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(a,b){return 0===a%b}],email:["Wrong email format","Bad email format",function(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}],"int":["Must be an integer","Should be an integer",function(a){return parseInt(a,10)==a}],"float":["Must be a decimal","Should be a decimal",function(a){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(a)}],min:["Must be >= {val}","Value is lower than {val}",function(a,b){return(parseFloat(a)||0)>=(parseFloat(b)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(a,b){return(parseFloat(a)||0)<=(parseFloat(b)||0)}],date:["Wrong date format","Bad date format",function(a){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(a)}],length:["Must be {val} characters long","Should be {val} characters long",function(a,b){return a.length==b}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(a,b){return a.length<=b}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(a,b){return a.length<=b}],required:["Required field","This field is highly recommended to fill",function(a){return!(""==a||null==a||"undefined"==typeof a)}]},Y={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,getPath:function(a){var b=a.replace(Y.isObjReg,""),c=[];b&&c.push(b);for(var d;d=Y.allReg.exec(a);)c.push(d[1]);return c},serialize:function(a,b){var c=[];for(var d in a){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"==typeof f&&null!==f?Y.serialize(f,e):encodeURIComponent(e)+"="+(null===f?"":encodeURIComponent(f)))}return c.join("&")},getOrDel:function(a,b,c){var d=this.getPath(a);if(void 0===b||void 0===b[d[0]])return void 0;for(var f,g,e=b,h=0;h<d.length;h++)if(void 0!==e[d[h]]){if(""==e[d[h]])return c?delete e[d[h]]:e[d[h]];f=e,g=d[h],e=e[d[h]]}return c?delete f[g]:e},del:function(a,b){return this.getOrDel(a,b,!0)},get:function(a,b){return this.getOrDel(a,b)},setVal:function(a,b,c){if(a.length){var d=a.shift(),e=a[0],f=c;if(void 0===e){if(""==d)return c.push?(c.push(b),void 0):!1;if(void 0===c)return;return c[d]=b,void 0}""==d&&(f.push||(f=[]),f.push(""==e?[]:{}),d=f.length-1),f=f[d]="object"==typeof f[d]&&null!==f[d]?f[d]:""==e?[]:{},Y.setVal(a,b,f)}},set:function(a,b,c){var d=this.getPath(a);Y.setVal(d,b,c)}};return function(a,b){void 0!==window.Element&&(a[b]||(a[b]=function(a){return this.querySelectorAll("."+a)},Element.prototype[b]=a[b]))}(document,"getElementsByClassName"),{Form:qb,remove:function(a){W[a]&&delete W[a]},VALIDATION_ON_SUBMIT:O,VALIDATION_ON_CHANGE:P,VALIDATION_ON_KEYUP:Q,FLAG_DEBUG:b,FLAG_SUBMIT_EMPTY:c,FLAG_UNIQUE_LABELS:a,FLAG_ASYNC:d}}();