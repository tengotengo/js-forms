Forms=function(){function e(){throw Error(Array[ot].slice.call(arguments).join(", "))}function t(){console.log(Array[ot].slice.call(arguments).join(", "))}function n(e){if(!(e[J][I]&N))return void(e.submit=function(t){e[et].submit(t)});var t=function(){var t=arguments[arguments[ut]-1],n="function"==typeof t?t:function(){},r=e[J][T]||e[rt][T],a=e[J][W]||e[rt][W],o=e[J][S]||e[rt][S],l=e[J][D]||e[rt][D],s=e[J][L]||function(t){if(t=t||function(){},e[J][nt])for(var n in e[J][nt])Pt.set(n,e[J][nt][n],e[Y]);e[rt][F](e.action,"POST",e[Y],function(t){return function(n,a){n&&e.saveChanges(),r.call(e,n,a,t)}}(t))};o(function(){e[Y]=i(e[et]);var t=e[G]();a(t,function(){s(n),l()})})};e[et].submit=e.submit=t,A(e[et],"submit",function(e){return e.preventDefault&&e.preventDefault(),t(),e.returnValue=!1,!1})}function r(e,t,n,r){var a="";switch(e){case"select":a='<select name="'+t+'" id="'+n+'">';for(var i,o=0;i=r[o];o++)a+=i.input;a+="</select>";break;case"radio":case"checkbox":a='<table cellpadding="0" cellspacing="0" class="forms-'+e+'-table">';for(var i,o=0;i=r[o];o++)a+='<tr><td class="forms-'+e+'">'+i.input+'</td><td class="forms-label-'+e+'">'+i.label+"</td></tr>";a+="</table>";break;default:return!1}return a}function a(e){var t=e.name,n=e.type,r=e.tagName.toLowerCase();if(!t||e.disabled||"reset"==n||"button"==n||"radio"==n&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==r&&-1==e.selectedIndex)return null;switch(r){case"select":var a=e.selectedIndex;if(0>a)return _t.select;for(var i=[],o=e.options,l="select-one"==n,s=l?a+1:o[ut],u=l?a:0;s>u;u++){var c=o[u];if(c.selected){var f=c.value;if(void 0===f&&(f=c.attributes&&c.attributes.value&&!c.attributes.value.specified?c.text:c.value),l)return void 0===f||""===f||null===f?_t.select:f;i.push(f)}}return i.join(",");case"input":switch(n){case"radio":return""===e.value?_t.radio:e.value;case"checkbox":return e.checked?e.value||"1":_t.checkbox;case"text":case"password":case"hidden":return e.value}break;case"textarea":return e.value;default:return null}}function i(e){var t={};if(!e[ut])return t;for(var n,r=0;n=e[r];r++){var i=n.name;if(i&&!n.disabled&&!d(n,"default-text")){var o=a(n);void 0===Pt.get(i,t)&&null===o&&Pt.set(i,null,t),null!==o&&(n.hasAttribute("bitmask")?(o=parseInt(o,10)||0,o|=Pt.get(i,t),Pt.set(i,o,t)):Pt.set(i,o,t))}}return t}function o(e,t){if(!e)return!1;var n=function(e,t){switch(e.tagName.toLowerCase()){case"select":for(var n,r=e.children,a=!1,i=0;n=r[i];i++)t!=n.value?(n.removeAttribute("selected"),n.selected=!1):(n.setAttribute("selected","1"),n.selected=!0,a=i);return a===!1?(e.selectedIndex=-1,!1):(e.selectedIndex=a,!0);case"input":switch(e.type){case"radio":return t==e.value?(e.setAttribute("checked","true"),e.checked=!0,!0):(e.removeAttribute("checked"),e.checked=!1,!1);case"password":case"hidden":case"text":return e.setAttribute("value",null===t?"":t),e.value=null===t?"":t,!0;case"checkbox":var o=e.hasAttribute("bitmask");return o&&e.value&t||t&&"0"!==t&&"!1"!==t&&!o?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1),!0}break;case"textarea":return e[at]=t,e.value=t,!0}},r=!1;if("object"==typeof t&&e[ut]&&null!==t){for(var a,i=0;a=e[i];i++)n(a,t)&&(r=!0);return r}if(e[ut]&&!e.tagName){for(var a,i=0;a=e[i];i++)n(a,t)&&(r=!0);return r}return n(e,t)}function l(e){return"[object Array]"===Object[ot].toString.call(e)}function s(e,t,n){if(e.elements[t]){var r=o(e.elements[t],n);r||(n=_t[e.elements[t].type||e.elements[t].tagName]);var a=l(e.elements[t])?e.elements[t][0]:e.elements[t];m(a)||Pt.set(t,n,e[Y])}}function u(e,t){return e.elements[t]?Pt.get(t,i(Array[ot].concat(e.elements[t]))):void 0}function c(e){return Rt[e]?Rt[e]:!1}function f(e,t){d(e,t)||(e.className=(e.className+" "+t).trim())}function d(e,t){return RegExp("( |^)"+t+"( |$)","g").test(e.className)}function v(e,t){var n=RegExp("( |^)"+t+"( |$)","g");e.className=e.className.replace(n,function(e,t,n){return t==n?n:""})}function h(e){var t=!this.elements;t&&(this.elements={});for(var n,r=0;n=this[et][r];r++)t&&(this.elements[n.name]?l(this.elements[n.name])?this.elements[n.name].push(n):this.elements[n.name]=Array[ot].concat(this.elements[n.name],n):this.elements[n.name]=n),e(n)}function m(e){return!!(e.type&&"disabled"==e.type||e.disabled||e.getAttribute("disabled"))}function g(){h.call(this,function(e){this.setField(e.name,"")}.bind(this))}function b(e,t,n){var r=document.createElement(n.toUpperCase());return r.setAttribute("class","form_"+t+"_"+e),r.setAttribute("name",e),r}function p(e,t){var n=document.createElement("SPAN");return n.className=e,f(n,t),n}function C(e,t,n){var r=this.notificationContainers[e];if(void 0===r[t]){var a=y(this[et],t,e);if(!a){if(!this[tt][t])return;a=b(t,e,this[tt][t].tagName),this[tt][t].parentNode.insertBefore(a,this[tt][t].nextSibling)}a.children[ut]||a.appendChild(p(n,this.options[rt][M])),r[t]=a}return this.notificationContainers[e][t].children[0]}function A(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),!0):e.attachEvent?e.attachEvent("on"+t,n):(t="on"+t,"function"==typeof e[t]&&(n=function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),e[t]=n,!0)}function y(e,t,n){var r;if(!e.allChildren){e.allChildren={};for(var a,i=e.getElementsByTagName("*"),o=0;a=i[o];o++)e.allChildren[a.className]=e.allChildren[a.className]||[],e.allChildren[a.className].push(a)}return r=e.allChildren["form_"+n+"_"+t],r?r&&void 0===r[ut]?r:1==r[ut]?r[0]:r[0]?r:null:null}function k(e,t,n){var r=e[J][B]||{},a=e[J][q],i=e[J][U]||e[rt][U];n=n||!1;var s=e[J][z]||!1,u=function(t,n,r){var a=Pt.get(n,this[Y]),o=e.getFieldValue(n),l=Pt.get(n,this[K]);if(differs(a,o,!0)){switch(Pt.set(n,o,this[Y]),r){case It:case Ft:this[G](n);break;case jt:}s&&s(n,o)}var u=differs(this[Q],{});differs(l,o,!0)?Pt.set(n,!0,this[Q]):Pt.del(n,this[Q]);var c=differs(this[Q],{});u!=c&&(this[st]=c,i(c,this))},c=function(t){var n=t.name;if(void 0===t.hasAttribute&&(t.hasAttribute=function(e){return void 0!==this[e]}),function(){(!t.type||"hidden"!=t.type&&"disabled"!=t.type)&&(t.setAttribute("tabindex",++Tt),t.formIndex=t.formIndex||Tt)}(),r[n])for(var i in r[n]){var o=null;switch(i){case Ct:case pt:if(t[ut])for(var l,s=0;l=t[s];s++)l.setAttribute(i,"1");else t.setAttribute(i,"1");break;case ft:o=r[n][i];for(var c in o)t.setAttribute(c,o[c]);break;case bt:if(o=r[n][i],"string"==typeof o)f(t,o);else try{for(var s=0;s<o[ut];s++)f(t,o[s])}catch(d){}}}if(!t[it]){var v=function(e){return function(t){u.call(this,t,e,a)}.bind(this)}.call(e,t.name);A(t,"blur",v),A(t,"click",v),A(t,"keyup",v),t[it]=!0}};for(var d in e.elements){var v=e.elements[d],h=Pt.get(d,t),g=function(t,n){var a=!1,i=r[d]?!!r[d][mt]:!1;if(void 0===h)if(r[d]&&void 0!==r[d][gt])h=r[d][gt];else if(r[d]&&r[d][ht]&&i){for(var l in r[d][ht])if(Object[ot][lt].call(r[d][ht],l)){h=r[d][ht][l];break}}else a=!0,h=_t[n.type||n.tagName];if(!(a&&m(n)||void 0!==Pt.get(d,e[Y]))){var s;s=o(t,h),s||(h=_t[n.type||n.tagName]),Pt.set(d,h,e[Y])}};if(l(v)){if(!n)for(var b,p=0;b=v[p];p++)c(b);g(v,v[0])}else n||c(v),g(v,v)}}function w(e,t,n){if(n=n||!1,t){var a=e[et];e[tt]={};var i=function(e,t){var n=document.createElement("LABEL");return n[at]=e,n.setAttribute("for",t),n};for(var o in t){var l=o+"",s=t[l],u=s[dt];if(u&&(e[tt][l]=y(a,l,yt),e[tt][l])){e[tt][l][at]="",d=l+"-"+Mt++;var c=y(a,l,xt);if(s.label&&c){c[at]="";var f=i(s.label,d);n&&f.setAttribute("title",l),c.appendChild(f)}var d,v={};s.data?v=s.data:s.label?v[s.label]=null:v[""]=null;{!!s[mt]}e[tt][l][at]=function(e,t,n,a,i){var o=[],l=1,s=0;for(var u in e)s++;var c=s>=2;for(var f in e){var d,v=t+(c?"-"+l:""),h={},m=null===e[f]?"":e[f];"select"==n?d='<option value="'+m+'">'+f+"</option>":(d="text"==n||"hidden"==n||"password"==n||"checkbox"==n||"radio"==n?'<input type="'+n+'" name="'+a+'" id="'+v+'" error-id="'+t+'" value="'+m+'" />':'<textarea name="'+a+'" id="'+v+'" error-id="'+t+'" >'+m+"</textarea>",h.label=i?"":'<label for="'+v+'">'+f+"</label>"),h.input=d,o.push(h),l++}var g=r(n,a,t,o);return g?g:o[0].input}(v,d,u,l,!!c)}}}}function x(r){function a(r){function a(e){return!!e}var c={},f=this;if(c[it]=!1,c[rt]=o,c[et]=null,c[J]=r||null,f.init=function(n){return c[it]?(t(Nt),!1):(a(n)||e(Et),c[J]=n,c[it]=!0,!0)},f[st]=!1,f[Y]={},f[K]={},f[Q]={},f[J]=c[J],f.options=c,f[rt]=o,!a(c[J]))return void t(Et);if(c[J][O]&&(c[et]=document.getElementById(c[J][O]),c[et]||e(Ot,c[J][O]),f[et]=c[et]),c[J][j]&&(f[et]=c[et]=c[J][j],c[J][O]=f[et].getAttribute("id")),!f[et])return void t(Ot);c[J][I]=c[J][I]?c[J][I]|o[I]:o[I],c[J][q]||(c[J][q]=o[q]),f.getFormData=function(){return f[Y]},c[J][ct]&&c[et].setAttribute(ct,c[J][ct]),f.action=c[et].getAttribute("action"),f.getFieldValue=function(e){return u(f,e)};var d=c[J][z]||!1;f.setField=function(e,t,n){s(f,e,t),n&&d&&d(e,t)},f.setFields=function(e,t){for(var n in e)Object[ot][lt].call(e,n)&&f.setField(n,e[n],t)},f.getField=function(e){return f.elements[e]},f[G]=function(e){return e?l.field(f,e,f[J][B][e],Pt.get(e,f[Y]),o[V],o[_]):f[J][G]?f[J][G](f,f[Y]):l.process(f)},f.clear=g.bind(f),f.notificationContainers={},f.notificationContainers[wt]={},f.notificationContainers[kt]={},f.getErrorContainer=function(e){return C.call(f,wt,e,o[V])},f.getWarningContainer=function(e){return C.call(f,kt,e,o[_])},f.saveChanges=function(){f[Q]={},f[K]=cloneObject(f[Y]),(c[J][U]||o[U])(!1,f),f[st]=!1},f.resetToDefaults=function(){f[Y]={},k(f,{},!0)},f.resetValidation=function(){l.reset(f)},f.checkForm=function(){var e=f.getAllValues();alert(differs(e,f[Y],1)?"something is wrong":"SUCCESSFUL")},f.getAllValues=function(){return i(f[et])},f[Y]=i(f[et]),w(f,c[J][B],!!(c[J][I]&E)),h.call(f,function(){}),k(f,f[J][Z]),c[J][H]&&c[J][H](f),n(f),f.saveChanges(),c[J][q]===Ft&&f[G](),f.remove=function(){Forms.remove(c[J][O])},f.remove(),Vt[c[J][O]]=f}var o={};o[I]=r[I]||0,o[q]=r[q]||Forms.VALIDATION_ON_SUBMIT,o[M]=r[M]||"h",o[V]=r[V]||"error",o[F]=r[F]||function(e,t,n,r,a){var i=new XMLHttpRequest;a=a||function(){},i.open(t,e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(Pt.serialize(n,null)),i.onreadystatechange=function(){200==i.status&&4==i.readyState&&r(!0,i.response),200!=i.status&&a()}},o[U]=r[U]||function(){},o[P]=r[P]||function(){},o[R]=r[R]||function(){},o[_]=r[_]||"warning",o[W]=r[W]||function(e,t){var n=!0;for(var r in e)1!=e[r]&&(n=!1);n&&t()},o[$]=r[$]||function(){return!0},o[D]=r[D]||function(){return!0},o[S]=r[S]||function(e){return e(),!0},o[T]=r[T]||function(e,t,n){return n(),!0};var l={methods:{},hideError:function(e){e&&f(e,o[M])},showError:function(e,t){e&&(e[at]=t,v(e,o[M]))},field:function(e,t,n,r,a,i){var o=!0,s=!0;if(!n)return s;if(n[vt]){e.notificationContainers[wt][t]&&l.hideError(e.getErrorContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&v(e.elements[t],a);for(var u in n[vt])if(Object[ot][lt].call(n[vt],u)){var d=l.methods[u]||c(u);if(d&&(("required"==u||""!=r&&null!==r&&void 0!==r)&&(o=d[Lt](r,n[vt][u])),!o)){l.showError(e.getErrorContainer(t),d[St].supplant({val:n[vt][u]})),e.elements[t]&&void 0!==e.elements[t].name&&f(e.elements[t],a),s=!1;break}}}if(n[At]){e.notificationContainers[kt][t]&&l.hideError(e.getWarningContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&v(e.elements[t],i);for(var u in n[At])if(Object[ot][lt].call(n[At],u)){var d=l.methods[u]||c(u);if(d)if(s){if(("required"==u||""!=r&&null!==r&&void 0!==r)&&(o=d[Lt](r,n[At][u])),!o){l.showError(e.getWarningContainer(t),d[Dt].supplant({val:n[At][u]})),e.elements[t]&&void 0!==e.elements[t].name&&f(e.elements[t],i),s="warning";break}}else e.notificationContainers[kt][t]&&l.hideError(e.getWarningContainer(t))}}return s},reset:function(e){var t=e[J][B];for(var n in t)Object[ot][lt].call(t,n)&&(t[n][vt]&&(e.notificationContainers[wt][n]&&l.hideError(e.getErrorContainer(n)),e.elements[n]&&void 0!==e.elements[n].name&&v(e.elements[n],o[V])),t[n][At]&&(e.notificationContainers[kt][n]&&l.hideError(e.getWarningContainer(n)),e.elements[n]&&void 0!==e.elements[n].name&&v(e.elements[n],o[_])))},process:function(e){var t={},n=e[J][B];for(var r in n)Object[ot][lt].call(n,r)&&(n[r][vt]||n[r][At])&&(t[r]=l.field(e,r,n[r],Pt.get(r,e[Y]),o[V],o[_]));return t}};if(r[X])for(var d in r[X])Object[ot][lt].call(r[X],d)&&(l.methods[d]=r[X][d]);this.create=a}var E=2,N=8,O="id",j="obj",I="flags",F="ajax",L="onSubmit",S="beforeSubmit",D="afterSubmit",T="submitCallback",M="hideClass",V="errorClass",_="warningClass",R="fieldContext",P="formContext",B="fields",q="validationType",z="onFieldChange",U="onChange",H="onInit",W="onValidate",$="onWarning",G="validate",X="validation",Z="data",Y="currentData",K="initialData",Q="differsObj",J="config",et="container",tt="fieldContainers",nt="params",rt="defaults",at="innerHTML",it="initialized",ot="prototype",lt="hasOwnProperty",st="isChanged",ut="length",ct="action",ft="attributes",dt="type",vt="validate",ht="data",mt="notEmpty",gt="defaultVal",bt="class",pt="bitmask",Ct="disabled",At="warning",yt="field",kt="warning",wt="error",xt="label",Et="No configuration passed",Nt="Form is initialized already",Ot="No such element on the page",jt=1,It=2,Ft=3,Lt=2,St=0,Dt=1,Tt=0,Mt=1,Vt={},_t={select:null,"select-one":null,text:"",textarea:"",radio:null,checkbox:""},Rt={multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(e,t){return e%t===0}],email:["Wrong email format","Bad email format",function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}],"int":["Must be an integer","Should be an integer",function(e){return parseInt(e,10)==e}],"float":["Must be a decimal","Should be a decimal",function(e){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(e)}],min:["Must be >= {val}","Value is lower than {val}",function(e,t){return(parseFloat(e)||0)>=(parseFloat(t)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(e,t){return(parseFloat(e)||0)<=(parseFloat(t)||0)}],date:["Wrong date format","Bad date format",function(e){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(e)}],length:["Must be {val} characters long","Should be {val} characters long",function(e,t){return e[ut]==t}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(e,t){return e[ut]<=t}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(e,t){return e[ut]<=t}],required:["Required field","This field should be filled",function(e){return!(""==e||null==e||void 0===e)}]},Pt={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,getPath:function(e){var t=e.replace(Pt.isObjReg,""),n=[];t&&n.push(t);for(var r;r=Pt.allReg.exec(e);)n.push(r[1]);return n},serialize:function(e,t){var n=[];for(var r in e){var a=t?t+"["+r+"]":r,i=e[r];n.push("object"==typeof i&&null!==i?Pt.serialize(i,a):encodeURIComponent(a)+"="+(null===i?"":encodeURIComponent(i)))}return n.join("&")},getOrDel:function(e,t,n){var r=this.getPath(e);if(void 0===t||void 0===t[r[0]])return void 0;for(var a,i,o=t,l=0;l<r[ut];l++)if(void 0!==o[r[l]]){if(""==o[r[l]])return n?delete o[r[l]]:o[r[l]];a=o,i=r[l],o=o[r[l]]}return n?delete a[i]:o},del:function(e,t){return this.getOrDel(e,t,!0)},get:function(e,t){return this.getOrDel(e,t)},setVal:function(e,t,n){if(e[ut]){var r=e.shift(),a=e[0],i=n;if(void 0===a){if(""==r)return n.push?void n.push(t):!1;if(void 0===n)return;return void(n[r]=t)}""==r&&(i.push||(i=[]),i.push(""==a?[]:{}),r=i[ut]-1),i=i[r]="object"==typeof i[r]&&null!==i[r]?i[r]:""==a?[]:{},Pt.setVal(e,t,i)}},set:function(e,t,n){var r=this.getPath(e);Pt.setVal(r,t,n)}};return function(e,t){void 0!==window.Element&&(e[t]||(e[t]=function(e){return this.querySelectorAll("."+e)},Element[ot][t]=e[t]))}(document,"getElementsByClassName"),{Form:x,remove:function(e){Vt[e]&&delete Vt[e]},getList:function(){return Vt},VALIDATION_ON_SUBMIT:jt,VALIDATION_ON_CHANGE:It,VALIDATION_ASAP:Ft,FLAG_DEBUG:E,FLAG_ASYNC:N}}();