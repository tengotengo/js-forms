Forms=function(){function e(){throw Error(Array[it].slice.call(arguments).join(", "))}function t(){console.log(Array[it].slice.call(arguments).join(", "))}function n(e){if(!(e[Q][j]&E))return void(e.submit=function(t){e[J].submit(t)});var t=function(){var t=arguments[arguments[st]-1],n="function"==typeof t?t:function(){},r=e[Q][D]||e[nt][D],a=e[Q][U]||e[nt][U],o=e[Q][L]||e[nt][L],l=e[Q][S]||e[nt][S],s=e[Q][F]||function(t){t=t||function(){},e[Z]=i(e[J]);var n=e[$]();if(a(n)){if(e[Q][tt])for(var o in e[Q][tt])Rt.set(o,e[Q][tt][o],e[Z]);return e[nt][I](e.action,"POST",e[Z],function(t){return function(n,a){n&&e.saveChanges(),r.call(e,n,a,t)}}(t)),!0}return!1};o(function(){s(n)&&l()})};e[J].submit=e.submit=t,y(e[J],"submit",function(e){return e.preventDefault&&e.preventDefault(),t(),e.returnValue=!1,!1})}function r(e,t,n,r){var a="";switch(e){case"select":a='<select name="'+t+'" id="'+n+'">';for(var i,o=0;i=r[o];o++)a+=i.input;a+="</select>";break;case"radio":case"checkbox":a='<table cellpadding="0" cellspacing="0" class="forms-'+e+'-table">';for(var i,o=0;i=r[o];o++)a+='<tr><td class="forms-'+e+'">'+i.input+'</td><td class="forms-label-'+e+'">'+i.label+"</td></tr>";a+="</table>";break;default:return!1}return a}function a(e){var t=e.name,n=e.type,r=e.tagName.toLowerCase();if(!t||e.disabled||"reset"==n||"button"==n||"radio"==n&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==r&&-1==e.selectedIndex)return null;switch(r){case"select":var a=e.selectedIndex;if(0>a)return Vt.select;for(var i=[],o=e.options,l="select-one"==n,s=l?a+1:o[st],u=l?a:0;s>u;u++){var c=o[u];if(c.selected){var f=c.value;if(void 0===f&&(f=c.attributes&&c.attributes.value&&!c.attributes.value.specified?c.text:c.value),l)return void 0===f||""===f||null===f?Vt.select:f;i.push(f)}}return i.join(",");case"input":switch(n){case"radio":return""===e.value?Vt.radio:e.value;case"checkbox":return e.checked?e.value||"1":Vt.checkbox;case"text":case"password":case"hidden":return e.value}break;case"textarea":return e.value;default:return null}}function i(e){var t={};if(!e[st])return t;for(var n,r=0;n=e[r];r++){var i=n.name;if(i&&!n.disabled&&!d(n,"default-text")){var o=a(n);void 0===Rt.get(i,t)&&null===o&&Rt.set(i,null,t),null!==o&&(n.hasAttribute("bitmask")?(o=parseInt(o,10)||0,o|=Rt.get(i,t),Rt.set(i,o,t)):Rt.set(i,o,t))}}return t}function o(e,t){if(!e)return!1;var n=function(e,t){switch(e.tagName.toLowerCase()){case"select":for(var n,r=e.children,a=!1,i=0;n=r[i];i++)t!=n.value?(n.removeAttribute("selected"),n.selected=!1):(n.setAttribute("selected","1"),n.selected=!0,a=i);return a===!1?(e.selectedIndex=-1,!1):(e.selectedIndex=a,!0);case"input":switch(e.type){case"radio":return t==e.value?(e.setAttribute("checked","true"),e.checked=!0,!0):(e.removeAttribute("checked"),e.checked=!1,!1);case"password":case"hidden":case"text":return e.setAttribute("value",null===t?"":t),e.value=null===t?"":t,!0;case"checkbox":var o=e.hasAttribute("bitmask");return o&&e.value&t||t&&"0"!==t&&"!1"!==t&&!o?(e.setAttribute("checked","true"),e.checked=!0):(e.removeAttribute("checked"),e.checked=!1),!0}break;case"textarea":return e[rt]=t,e.value=t,!0}},r=!1;if("object"==typeof t&&e[st]&&null!==t){for(var a,i=0;a=e[i];i++)n(a,t)&&(r=!0);return r}if(e[st]&&!e.tagName){for(var a,i=0;a=e[i];i++)n(a,t)&&(r=!0);return r}return n(e,t)}function l(e){return"[object Array]"===Object[it].toString.call(e)}function s(e,t,n){if(e.elements[t]){var r=o(e.elements[t],n);if(r){var a=l(e.elements[t])?e.elements[t][0]:e.elements[t];m(a)||Rt.set(t,n,e[Z])}}}function u(e,t){return e.elements[t]?Rt.get(t,i(Array[it].concat(e.elements[t]))):void 0}function c(e){return _t[e]?_t[e]:!1}function f(e,t){d(e,t)||(e.className=(e.className+" "+t).trim())}function d(e,t){return RegExp("( |^)"+t+"( |$)","g").test(e.className)}function v(e,t){var n=RegExp("( |^)"+t+"( |$)","g");e.className=e.className.replace(n,function(e,t,n){return t==n?n:""})}function h(e){var t=!this.elements;t&&(this.elements={});for(var n,r=0;n=this[J][r];r++)t&&(this.elements[n.name]?l(this.elements[n.name])?this.elements[n.name].push(n):this.elements[n.name]=Array[it].concat(this.elements[n.name],n):this.elements[n.name]=n),e(n)}function m(e){return!!(e.type&&"disabled"==e.type||e.disabled||e.getAttribute("disabled"))}function g(){h.call(this,function(e){this.setField(e.name,"")}.bind(this))}function b(e,t,n){var r=document.createElement(n.toUpperCase());return r.setAttribute("class","form_"+t+"_"+e),r.setAttribute("name",e),r}function p(e,t){var n=document.createElement("SPAN");return n.className=e,f(n,t),n}function C(e,t,n){var r=this.notificationContainers[e];if(void 0===r[t]){var a=A(this[J],t,e);if(!a){if(!this[et][t])return;a=b(t,e,this[et][t].tagName),this[et][t].parentNode.insertBefore(a,this[et][t].nextSibling)}a.children[st]||a.appendChild(p(n,this.options[nt][T])),r[t]=a}return this.notificationContainers[e][t].children[0]}function y(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),!0):e.attachEvent?e.attachEvent("on"+t,n):(t="on"+t,"function"==typeof e[t]&&(n=function(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),e[t]=n,!0)}function A(e,t,n){var r;if(!e.allChildren){e.allChildren={};for(var a,i=e.getElementsByTagName("*"),o=0;a=i[o];o++)e.allChildren[a.className]=e.allChildren[a.className]||[],e.allChildren[a.className].push(a)}return r=e.allChildren["form_"+n+"_"+t],r?r&&void 0===r[st]?r:1==r[st]?r[0]:r[0]?r:null:null}function k(e,t,n){if(n=n||!1,t){var a=e[J];e[et]={};var i=function(e,t){var n=document.createElement("LABEL");return n[rt]=e,n.setAttribute("for",t),n};for(var o in t){var l=o+"",s=t[l],u=s[ft];if(u&&(e[et][l]=A(a,l,yt),e[et][l])){e[et][l][rt]="",d=l+"-"+Tt++;var c=A(a,l,wt);if(s.label&&c){c[rt]="";var f=i(s.label,d);n&&f.setAttribute("title",l),c.appendChild(f)}var d,v={};s.data?v=s.data:s.label?v[s.label]=null:v[""]=null;{!!s[ht]}e[et][l][rt]=function(e,t,n,a,i){var o=[],l=1,s=0;for(var u in e)s++;var c=s>=2;for(var f in e){var d,v=t+(c?"-"+l:""),h={},m=null===e[f]?"":e[f];"select"==n?d='<option value="'+m+'">'+f+"</option>":(d="text"==n||"hidden"==n||"password"==n||"checkbox"==n||"radio"==n?'<input type="'+n+'" name="'+a+'" id="'+v+'" error-id="'+t+'" value="'+m+'" />':'<textarea name="'+a+'" id="'+v+'" error-id="'+t+'" >'+m+"</textarea>",h.label=i?"":'<label for="'+v+'">'+f+"</label>"),h.input=d,o.push(h),l++}var g=r(n,a,t,o);return g?g:o[0].input}(v,d,u,l,!!c)}}}}function w(r){function a(r){function a(e){return!!e}var c={},v=this;if(c[at]=!1,c[nt]=d,c[J]=null,c[Q]=r||null,v.init=function(n){return c[at]?(t(Et),!1):(a(n)||e(xt),c[Q]=n,c[at]=!0,!0)},v[lt]=!1,v[Z]={},v[Y]={},v[K]={},v[Q]=c[Q],v.options=c,v[nt]=d,!a(c[Q]))return void t(xt);if(c[Q][N]&&(c[J]=document.getElementById(c[Q][N]),c[J]||e(Nt,c[Q][N]),v[J]=c[J]),c[Q][O]&&(v[J]=c[J]=c[Q][O],c[Q][N]=v[J].getAttribute("id")),!v[J])return void t(Nt);c[Q][j]=c[Q][j]?c[Q][j]|d[j]:d[j],c[Q][B]||(c[Q][B]=d[B]),v.getFormData=function(){return v[Z]},c[Q][ut]&&c[J].setAttribute(ut,c[Q][ut]),v.action=c[J].getAttribute("action"),v.getFieldValue=function(e){return u(v,e)},v.setField=function(e,t,n){s(v,e,t),n&&b&&b(e,t)},v.setFields=function(e,t){for(var n in e)Object[it][ot].call(e,n)&&v.setField(n,e[n],t)},v.getField=function(e){return v.elements[e]},v[$]=function(e){return e?m.field(v,e,v[Q][P][e],Rt.get(e,v[Z]),d[M],d[V]):v[Q][$]?v[Q][$](v,v[Z]):m.process(v,c[Q][P])},v.clear=g.bind(v),v.notificationContainers={},v.notificationContainers[kt]={},v.notificationContainers[At]={},v.getErrorContainer=function(e){return C.call(v,kt,e,d[M])},v.getWarningContainer=function(e){return C.call(v,At,e,d[V])};var b=c[Q][z]||!1;v.initInputs=function(){var e=c[Q][P]||{},t=c[Q][X],n=c[Q][B],r=c[Q][q]||d[q],a=function(e,t,n){var a=Rt.get(t,this[Z]),i=v.getFieldValue(t),o=Rt.get(t,this[Y]);switch(differs(a,i,!0)&&(Rt.set(t,i,this[Z]),b&&b(t,i)),n){case jt:"blur"==e.type&&this[$](t);break;case It:this[$](t);break;case Ot:}var l=differs(this[K],{});differs(o,i,!0)?Rt.set(t,!0,this[K]):Rt.del(t,this[K]);var s=differs(this[K],{});l!=s&&(this[lt]=s,r(s,this))},i=function(t){var r=t.name;if(void 0===t.hasAttribute&&(t.hasAttribute=function(e){return void 0!==this[e]}),function(){(!t.type||"hidden"!=t.type&&"disabled"!=t.type)&&(t.setAttribute("tabindex",++Dt),t.formIndex=t.formIndex||Dt)}(),e[r])for(var i in e[r]){var o=null;switch(i){case pt:case bt:if(t[st])for(var l,s=0;l=t[s];s++)l.setAttribute(i,"1");else t.setAttribute(i,"1");break;case ct:o=e[r][i];for(var u in o)t.setAttribute(u,o[u]);break;case gt:if(o=e[r][i],"string"==typeof o)f(t,o);else try{for(var s=0;s<o[st];s++)f(t,o[s])}catch(c){}}}if(!t[at]){var d=function(e){return function(t){a.call(this,t,e,n)}.bind(this)}.call(v,t.name);y(t,"blur",d),y(t,"click",d),y(t,"keyup",d),t[at]=!0}};for(var s in v.elements){var u=v.elements[s],h=Rt.get(s,t),m=function(t,n){var r=!1,a=e[s]?!!e[s][ht]:!1;if(void 0===h)if(e[s]&&void 0!==e[s][mt])h=e[s][mt];else if(e[s]&&e[s][vt]&&a){for(var i in e[s][vt])if(Object[it][ot].call(e[s][vt],i)){h=e[s][vt][i];break}}else r=!0,h=Vt[n.type||n.tagName];if(void 0===Rt.get(s,v[Z])){var l;l=o(t,h),l||(h=Vt[n.type||n.tagName]),Rt.set(s,h,v[Z])}};if(l(u)){for(var g,p=0;g=u[p];p++)i(g);m(u,u[0])}else i(u),m(u,u)}},v.saveChanges=function(){v[K]={},v[Y]=cloneObject(v[Z]),(c[Q][q]||d[q])(!1,v),v[lt]=!1},v.resetToDefaults=function(e){var t=c[Q][P]||{};h.call(v,function(n){if(t[n.name]){var r=t[n.name][mt];t[n.name]&&void 0!==r&&(o(n,r),Rt.set(n.name,r,v[Z]),e&&b&&b(n.name,r))}})},v.checkForm=function(){var e=v.getAllValues();alert(differs(e,v[Z],1)?"something is wrong":"SUCCESSFUL")},v.getAllValues=function(){return i(v[J])},v[Z]=i(v[J]),k(v,c[Q][P],!!(c[Q][j]&x)),h.call(v,function(){}),v.initInputs(),c[Q][H]&&c[Q][H](v),n(v),v.saveChanges(),c[Q][B]===It&&v[$](),v.remove=function(){Forms.remove(c[Q][N])},v.remove(),Mt[c[Q][N]]=v}var d={};d[j]=r[j]||0,d[B]=r[B]||Forms.VALIDATION_ON_SUBMIT,d[T]=r[T]||"h",d[M]=r[M]||"error",d[I]=r[I]||function(e,t,n,r,a){var i=new XMLHttpRequest;a=a||function(){},i.open(t,e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(Rt.serialize(n,null)),i.onreadystatechange=function(){200==i.status&&4==i.readyState&&r(!0,i.response),200!=i.status&&a()}},d[q]=r[q]||function(){},d[R]=r[R]||function(){},d[_]=r[_]||function(){},d[V]=r[V]||"warning",d[U]=r[U]||function(e){var t=!0;for(var n in e)1!=e[n]&&(t=!1);return t},d[W]=r[W]||function(){return!0},d[S]=r[S]||function(){return!0},d[L]=r[L]||function(e){return e(),!0},d[D]=r[D]||function(e,t,n){return n(),!0};var m={methods:{},hideError:function(e){e&&f(e,d[T])},showError:function(e,t){e&&(e[rt]=t,v(e,d[T]))},field:function(e,t,n,r,a,i){var o=!0,l=!0;if(!n)return l;if(n[dt])for(var s in n[dt])if(Object[it][ot].call(n[dt],s)){var u=m.methods[s]||c(s);if(u){if(("required"==s||""!=r&&null!==r&&void 0!==r)&&(o=u[Ft](r,n[dt][s])),!o){m.showError(e.getErrorContainer(t),u[Lt].supplant({val:n[dt][s]})),e.elements[t]&&void 0!==e.elements[t].name&&f(e.elements[t],a),l=!1;break}e.notificationContainers[kt][t]&&m.hideError(e.getErrorContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&v(e.elements[t],a)}}if(n[Ct])for(var s in n[Ct])if(Object[it][ot].call(n[Ct],s)){var u=m.methods[s]||c(s);if(u)if(l){if(("required"==s||""!=r&&null!==r&&void 0!==r)&&(o=u[Ft](r,n[Ct][s])),!o){m.showError(e.getWarningContainer(t),u[St].supplant({val:n[Ct][s]})),e.elements[t]&&void 0!==e.elements[t].name&&f(e.elements[t],i),l="warning";break}e.notificationContainers[At][t]&&m.hideError(e.getWarningContainer(t)),e.elements[t]&&void 0!==e.elements[t].name&&v(e.elements[t],i)}else e.notificationContainers[At][t]&&m.hideError(e.getWarningContainer(t))}return l},process:function(e,t){var n={};for(var r in t)Object[it][ot].call(t,r)&&(t[r][dt]||t[r][Ct])&&(n[r]=m.field(e,r,t[r],Rt.get(r,e[Z]),d[M],d[V]));return n}};if(r[G])for(var b in r[G])Object[it][ot].call(r[G],b)&&(m.methods[b]=r[G][b]);this.create=a}var x=2,E=8,N="id",O="obj",j="flags",I="ajax",F="onSubmit",L="beforeSubmit",S="afterSubmit",D="submitCallback",T="hideClass",M="errorClass",V="warningClass",_="fieldContext",R="formContext",P="fields",B="validationType",z="onFieldChange",q="onChange",H="onInit",U="onValidate",W="onWarning",$="validate",G="validation",X="data",Z="currentData",Y="initialData",K="differsObj",Q="config",J="container",et="fieldContainers",tt="params",nt="defaults",rt="innerHTML",at="initialized",it="prototype",ot="hasOwnProperty",lt="isChanged",st="length",ut="action",ct="attributes",ft="type",dt="validate",vt="data",ht="notEmpty",mt="defaultVal",gt="class",bt="bitmask",pt="disabled",Ct="warning",yt="field",At="warning",kt="error",wt="label",xt="No configuration passed",Et="Form is initialized already",Nt="No such element on the page",Ot=1,jt=2,It=3,Ft=2,Lt=0,St=1,Dt=0,Tt=1,Mt={},Vt={select:null,"select-one":null,text:"",textarea:"",radio:null,checkbox:""},_t={multiple:["Must be a multiple of {val}","Should be a multiple of {val}",function(e,t){return e%t===0}],email:["Wrong email format","Bad email format",function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}],"int":["Must be an integer","Should be an integer",function(e){return parseInt(e,10)==e}],"float":["Must be a decimal","Should be a decimal",function(e){return/^-?\d{0,}([\.|\,]\d{0,})?$/.test(e)}],min:["Must be >= {val}","Value is lower than {val}",function(e,t){return(parseFloat(e)||0)>=(parseFloat(t)||0)}],max:["Must be <= {val}","Value is higher than {val}",function(e,t){return(parseFloat(e)||0)<=(parseFloat(t)||0)}],date:["Wrong date format","Bad date format",function(e){return/^([1-9]|0[1-9]|1[012])[- \/.](0[1-9]|[1-9]|[12][0-9]|3[01])[- \/.](19|20)\d\d$/.test(e)}],length:["Must be {val} characters long","Should be {val} characters long",function(e,t){return e[st]==t}],maxLength:["Must be <= {val} characters long","Should be less than {val} characters long",function(e,t){return e[st]<=t}],minLength:["Must be >= {val} characters long","Should be more than {val} characters long",function(e,t){return e[st]<=t}],required:["Required field","This field should be filled",function(e){return!(""==e||null==e||void 0===e)}]},Rt={allReg:/\[([a-zA-Z0-9-]*)\]/g,isObjReg:/\[(.*)\]/g,getPath:function(e){var t=e.replace(Rt.isObjReg,""),n=[];t&&n.push(t);for(var r;r=Rt.allReg.exec(e);)n.push(r[1]);return n},serialize:function(e,t){var n=[];for(var r in e){var a=t?t+"["+r+"]":r,i=e[r];n.push("object"==typeof i&&null!==i?Rt.serialize(i,a):encodeURIComponent(a)+"="+(null===i?"":encodeURIComponent(i)))}return n.join("&")},getOrDel:function(e,t,n){var r=this.getPath(e);if(void 0===t||void 0===t[r[0]])return void 0;for(var a,i,o=t,l=0;l<r[st];l++)if(void 0!==o[r[l]]){if(""==o[r[l]])return n?delete o[r[l]]:o[r[l]];a=o,i=r[l],o=o[r[l]]}return n?delete a[i]:o},del:function(e,t){return this.getOrDel(e,t,!0)},get:function(e,t){return this.getOrDel(e,t)},setVal:function(e,t,n){if(e[st]){var r=e.shift(),a=e[0],i=n;if(void 0===a){if(""==r)return n.push?void n.push(t):!1;if(void 0===n)return;return void(n[r]=t)}""==r&&(i.push||(i=[]),i.push(""==a?[]:{}),r=i[st]-1),i=i[r]="object"==typeof i[r]&&null!==i[r]?i[r]:""==a?[]:{},Rt.setVal(e,t,i)}},set:function(e,t,n){var r=this.getPath(e);Rt.setVal(r,t,n)}};return function(e,t){void 0!==window.Element&&(e[t]||(e[t]=function(e){return this.querySelectorAll("."+e)},Element[it][t]=e[t]))}(document,"getElementsByClassName"),{Form:w,remove:function(e){Mt[e]&&delete Mt[e]},getList:function(){return Mt},VALIDATION_ON_SUBMIT:Ot,VALIDATION_ON_CHANGE:jt,VALIDATION_ASAP:It,FLAG_DEBUG:x,FLAG_ASYNC:E}}();